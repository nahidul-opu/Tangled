From 738fcd2a1ea9f97f22bc1cc1c13c43fd357702a4 Mon Sep 17 00:00:00 2001
From: Claudio Martella <claudio@apache.org>
Date: Thu, 15 Aug 2013 17:24:27 +0200
Subject: [PATCH] GIRAPH-735

---
 CHANGELOG                                                      | 3 +++
 .../org/apache/giraph/partition/DiskBackedPartitionStore.java  | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG b/CHANGELOG
index f3bba6eff..c9b8a150a 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,9 @@
 Giraph Change Log
 
 Release 1.1.0 - unreleased
+  GIRAPH-735: DiskBackedPartitionStore throws NPE due to uninitialized OutEdges
+  (claudio)
+
   GIRAPH-734: DiskBackedPartitionStore attempting to release a lock it doesn't own
   (cmuchinsky via claudio)
 
diff --git a/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java b/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java
index 87e04c1b4..1a16dbe3c 100644
--- a/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java
+++ b/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java
@@ -402,7 +402,7 @@ private void readVertexData(DataInput in, Vertex<I, V, E> vertex)
     id.readFields(in);
     V value = conf.createVertexValue();
     value.readFields(in);
-    OutEdges<I, E> edges = conf.createOutEdges();
+    OutEdges<I, E> edges = conf.createAndInitializeOutEdges(0);
     vertex.initialize(id, value, edges);
     if (in.readBoolean()) {
       vertex.voteToHalt();
