From 152229433b57b9d97439dc4394df934f2790221f Mon Sep 17 00:00:00 2001
From: Xavier Hanin <xavier@apache.org>
Date: Fri, 29 Jun 2007 09:43:27 +0000
Subject: [PATCH] FIX: pom.groupId is not recognized in maven 2 pom parser
 (IVY-550)

git-svn-id: https://svn.apache.org/repos/asf/incubator/ivy/core/trunk@551837 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                                     | 1 +
 .../apache/ivy/plugins/parser/m2/PomModuleDescriptorParser.java | 2 ++
 test/java/org/apache/ivy/plugins/parser/m2/test-properties.pom  | 2 +-
 3 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index 35dd1d95c..15a58393c 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -63,6 +63,7 @@ for detailed view of each issue, please consult http://issues.apache.org/jira/br
 - IMPROVEMENT: Javadoc improvements (IVY-544) (with contribution from Tjeerd Verhagen)
 - IMPROVEMENT: Unit test improvements (IVY-545) (thanks to Tjeerd Verhagen)
 
+- FIX: pom.groupId is not recognized in maven 2 pom parser (IVY-550)
 - FIX: Evicted modules report depends on the order of the dependencies (IVY-526)
 - FIX: Ivy does not work on Turkish machines (IVY-65)
 - FIX: Ivy does not handle multiple version dependencies in maven2 poms correctly (IVY-494)
diff --git a/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorParser.java b/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorParser.java
index 49c7806e3..d8f933385 100644
--- a/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorParser.java
+++ b/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorParser.java
@@ -197,7 +197,9 @@ private void fillMrid() throws SAXException {
             }
             ModuleRevisionId mrid = ModuleRevisionId.newInstance(organisation, module, revision);
             properties.put("project.groupId", organisation);
+            properties.put("pom.groupId", organisation);
             properties.put("project.artifactId", module);
+            properties.put("pom.artifactId", module);
             properties.put("project.version", revision);
             properties.put("pom.version", revision);
             properties.put("version", revision);
diff --git a/test/java/org/apache/ivy/plugins/parser/m2/test-properties.pom b/test/java/org/apache/ivy/plugins/parser/m2/test-properties.pom
index ec54bd59b..e3cc08e9a 100644
--- a/test/java/org/apache/ivy/plugins/parser/m2/test-properties.pom
+++ b/test/java/org/apache/ivy/plugins/parser/m2/test-properties.pom
@@ -24,7 +24,7 @@
   <version>2.0-beta-18</version>
   <dependencies>
     <dependency>
-      <groupId>drools</groupId>
+      <groupId>${pom.groupId}</groupId>
       <artifactId>drools-core</artifactId>
       <version>${pom.version}</version>
     </dependency>
