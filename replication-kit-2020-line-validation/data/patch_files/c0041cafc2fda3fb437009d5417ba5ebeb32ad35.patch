From c0041cafc2fda3fb437009d5417ba5ebeb32ad35 Mon Sep 17 00:00:00 2001
From: Henri Yandell <bayard@apache.org>
Date: Tue, 22 Jun 2010 06:19:29 +0000
Subject: [PATCH] Escaping supplementary chars seems good for
 NumericEntityEscaper. LANG-617

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/lang/trunk@956782 13f79535-47bb-0310-9956-ffa450edef68
---
 .../lang3/text/translate/NumericEntityEscaper.java   |  1 -
 .../text/translate/NumericEntityEscaperTest.java     | 12 ++++++++++++
 2 files changed, 12 insertions(+), 1 deletion(-)

diff --git a/src/main/java/org/apache/commons/lang3/text/translate/NumericEntityEscaper.java b/src/main/java/org/apache/commons/lang3/text/translate/NumericEntityEscaper.java
index 44efb7cd7a2..624556db23a 100644
--- a/src/main/java/org/apache/commons/lang3/text/translate/NumericEntityEscaper.java
+++ b/src/main/java/org/apache/commons/lang3/text/translate/NumericEntityEscaper.java
@@ -72,7 +72,6 @@ public boolean translate(int codepoint, Writer out) throws IOException {
             }
         }
 
-        // TODO: if (codepoint > 0xffff) ?
         out.write("&#");
         out.write(Integer.toString(codepoint, 10));
         out.write(';');
diff --git a/src/test/java/org/apache/commons/lang3/text/translate/NumericEntityEscaperTest.java b/src/test/java/org/apache/commons/lang3/text/translate/NumericEntityEscaperTest.java
index 4ad44831f69..9bf93f9d4af 100644
--- a/src/test/java/org/apache/commons/lang3/text/translate/NumericEntityEscaperTest.java
+++ b/src/test/java/org/apache/commons/lang3/text/translate/NumericEntityEscaperTest.java
@@ -47,4 +47,16 @@ public void testAbove() {
         String result = nee.translate(input);
         assertEquals("Failed to escape numeric entities via the above method", "ADF&#71;&#90;", result);
     }
+
+    // See LANG-617
+    public void testSupplementary() {
+        NumericEntityEscaper nee = new NumericEntityEscaper();
+        String input = "\uD803\uDC22";
+        String expected = "&#68642;";
+
+        String result = nee.translate(input);
+        assertEquals("Failed to escape numeric entities supplementary characters", expected, result);
+
+    }
+
 }
