From 62e56cd3884d224e42cc8b449ef631a0909a19a3 Mon Sep 17 00:00:00 2001
From: Thomas Neidhart <tn@apache.org>
Date: Tue, 6 May 2014 20:42:24 +0000
Subject: [PATCH] [COLLECTIONS-512] Fix equals method of FixedOrderComparator.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/collections/trunk@1592874 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                |  3 ++-
 .../collections4/comparators/FixedOrderComparator.java | 10 +++++-----
 2 files changed, 7 insertions(+), 6 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 6673cf8aee..41675dd12b 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -23,7 +23,8 @@
 
   <release version="4.1" date="TBD" description="">
     <action issue="COLLECTIONS-512" dev="tn" type="fix" due-to="Cyrille Artho">
-      "TransformingComparator" did not comply with the contract of Object#equals.
+      "TransformingComparator" and "FixedOrderComparator" did not comply with
+      the contract of "Object#equals".
     </action>
     <action issue="COLLECTIONS-510" dev="tn" type="fix" due-to="Hollis Waite">
       Fix compilation errors when using source level 1.8 and a recent java 8 compiler.
diff --git a/src/main/java/org/apache/commons/collections4/comparators/FixedOrderComparator.java b/src/main/java/org/apache/commons/collections4/comparators/FixedOrderComparator.java
index 03f34d9fc1..3629b9ccaf 100644
--- a/src/main/java/org/apache/commons/collections4/comparators/FixedOrderComparator.java
+++ b/src/main/java/org/apache/commons/collections4/comparators/FixedOrderComparator.java
@@ -285,12 +285,12 @@ public boolean equals(final Object object) {
         }
         if (object.getClass().equals(this.getClass())) {
             final FixedOrderComparator<?> comp = (FixedOrderComparator<?>) object;
-            return null == map ? null == comp.map : map.equals(comp.map) &&
-                    null == unknownObjectBehavior ? null == comp.unknownObjectBehavior :
+            return (null == map ? null == comp.map : map.equals(comp.map)) &&
+                   (null == unknownObjectBehavior ? null == comp.unknownObjectBehavior :
                         unknownObjectBehavior == comp.unknownObjectBehavior &&
-                    counter == comp.counter &&
-                    isLocked == comp.isLocked &&
-                    unknownObjectBehavior == comp.unknownObjectBehavior;
+                        counter == comp.counter &&
+                        isLocked == comp.isLocked &&
+                        unknownObjectBehavior == comp.unknownObjectBehavior);
         }
         return false;
     }
