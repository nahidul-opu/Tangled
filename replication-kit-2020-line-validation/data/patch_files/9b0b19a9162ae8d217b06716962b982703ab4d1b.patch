From 9b0b19a9162ae8d217b06716962b982703ab4d1b Mon Sep 17 00:00:00 2001
From: Henri Yandell <bayard@apache.org>
Date: Tue, 12 Dec 2006 22:34:39 +0000
Subject: [PATCH] Applying a unit test for LANG-299 and the fix that Francisco
 Benavent suggests.

git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/lang/trunk@486377 13f79535-47bb-0310-9956-ffa450edef68
---
 src/java/org/apache/commons/lang/text/StrBuilder.java      | 2 +-
 .../commons/lang/text/StrBuilderAppendInsertTest.java      | 7 +++++++
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/src/java/org/apache/commons/lang/text/StrBuilder.java b/src/java/org/apache/commons/lang/text/StrBuilder.java
index 886d424ea02..4c1450995ab 100644
--- a/src/java/org/apache/commons/lang/text/StrBuilder.java
+++ b/src/java/org/apache/commons/lang/text/StrBuilder.java
@@ -881,7 +881,7 @@ public StrBuilder appendFixedWidthPadRight(Object obj, int width, char padChar)
             String str = (obj == null ? getNullText() : obj.toString());
             int strLen = str.length();
             if (strLen >= width) {
-                str.getChars(0, strLen, buffer, size);
+                str.getChars(0, width, buffer, size);
             } else {
                 int padLen = width - strLen;
                 str.getChars(0, strLen, buffer, size);
diff --git a/src/test/org/apache/commons/lang/text/StrBuilderAppendInsertTest.java b/src/test/org/apache/commons/lang/text/StrBuilderAppendInsertTest.java
index c154913ee70..8feb53c9d06 100644
--- a/src/test/org/apache/commons/lang/text/StrBuilderAppendInsertTest.java
+++ b/src/test/org/apache/commons/lang/text/StrBuilderAppendInsertTest.java
@@ -596,6 +596,13 @@ public void testAppendFixedWidthPadRight() {
         assertEquals("null-", sb.toString());
     }
 
+    // See: http://issues.apache.org/jira/browse/LANG-299
+    public void testLang299() {
+        StrBuilder sb = new StrBuilder(1);
+        sb.appendFixedWidthPadRight("foo", 1, '-');
+        assertEquals("f", sb.toString());
+    }
+
     //-----------------------------------------------------------------------
     public void testAppendFixedWidthPadRight_int() {
         StrBuilder sb = new StrBuilder();
