From ac7e5e4ff9b2a2e4ece0ac348ab95465617bf078 Mon Sep 17 00:00:00 2001
From: Maarten Coene <maartenc@apache.org>
Date: Mon, 7 Dec 2009 23:24:38 +0000
Subject: [PATCH] Added junit test for IVY-956

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@888184 13f79535-47bb-0310-9956-ffa450edef68
---
 .../apache/ivy/core/resolve/ResolveTest.java  | 13 ++++++++++
 .../org/apache/ivy/core/resolve/ivy-956.xml   | 25 +++++++++++++++++++
 2 files changed, 38 insertions(+)
 create mode 100644 test/java/org/apache/ivy/core/resolve/ivy-956.xml

diff --git a/test/java/org/apache/ivy/core/resolve/ResolveTest.java b/test/java/org/apache/ivy/core/resolve/ResolveTest.java
index ff81f6ff6..773f3c2e7 100644
--- a/test/java/org/apache/ivy/core/resolve/ResolveTest.java
+++ b/test/java/org/apache/ivy/core/resolve/ResolveTest.java
@@ -54,6 +54,8 @@
 import org.apache.ivy.plugins.circular.ErrorCircularDependencyStrategy;
 import org.apache.ivy.plugins.circular.IgnoreCircularDependencyStrategy;
 import org.apache.ivy.plugins.circular.WarnCircularDependencyStrategy;
+import org.apache.ivy.plugins.conflict.LatestCompatibleConflictManager;
+import org.apache.ivy.plugins.conflict.StrictConflictException;
 import org.apache.ivy.plugins.matcher.ExactPatternMatcher;
 import org.apache.ivy.plugins.parser.xml.XmlModuleDescriptorParser;
 import org.apache.ivy.plugins.resolver.BasicResolver;
@@ -4985,4 +4987,15 @@ public void testExtraAttributesMultipleDependenciesNoHang2() throws Exception {
             getResolveOptions(ivy.getSettings(), new String[] {"*"}).setValidate(false));
         assertFalse(report.hasError());
     }
+
+    public void testIVY956() throws Exception {
+        ivy.getSettings().setDefaultConflictManager(ivy.getSettings().getConflictManager("latest-compatible"));
+        try {
+            ResolveReport report = ivy.resolve(ResolveTest.class.getResource("ivy-956.xml"),
+                getResolveOptions(ivy.getSettings(), new String[] {"*"}).setValidate(false));
+            fail("No StrictConflictException has been thrown");
+        } catch (StrictConflictException e) {
+            // ignore
+        }
+    }
 }
diff --git a/test/java/org/apache/ivy/core/resolve/ivy-956.xml b/test/java/org/apache/ivy/core/resolve/ivy-956.xml
new file mode 100644
index 000000000..5883c80bc
--- /dev/null
+++ b/test/java/org/apache/ivy/core/resolve/ivy-956.xml
@@ -0,0 +1,25 @@
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one
+   or more contributor license agreements.  See the NOTICE file
+   distributed with this work for additional information
+   regarding copyright ownership.  The ASF licenses this file
+   to you under the Apache License, Version 2.0 (the
+   "License"); you may not use this file except in compliance
+   with the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing,
+   software distributed under the License is distributed on an
+   "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+   KIND, either express or implied.  See the License for the
+   specific language governing permissions and limitations
+   under the License.    
+-->
+<ivy-module version="1.0">
+    <info organisation="apache" module="ivy-956" />
+    <dependencies>
+    	<dependency org="org1" name="mod1.4" rev="1.0.2" />
+    	<dependency org="org1" name="mod1.2" rev="[0.9,1.0[" extra="yes"/>
+    </dependencies>
+</ivy-module>
