From eb4c6dad6ca47dd43bf127f63870df8031fdfe72 Mon Sep 17 00:00:00 2001
From: Avery Ching <aching@apache.org>
Date: Wed, 18 Jan 2012 23:04:46 +0000
Subject: [PATCH] GIRAPH-125: Bug in
 LongDoubleFloatDoubleVertex.sendMsgToAllEdges(). (humming80 via aching)

git-svn-id: https://svn.apache.org/repos/asf/incubator/giraph/trunk@1233107 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGELOG                                                  | 7 +++++--
 .../apache/giraph/graph/LongDoubleFloatDoubleVertex.java   | 4 +---
 2 files changed, 6 insertions(+), 5 deletions(-)

diff --git a/CHANGELOG b/CHANGELOG
index a6268f79b..cc1d209fd 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,10 +1,13 @@
 Giraph Change Log
 
 Release 0.1.0 - unreleased
+  
+  GIRAPH-125: Bug in LongDoubleFloatDoubleVertex.sendMsgToAllEdges().
+  (humming80 via aching)
 
-  GIRAPH-122. Roll version back to 0.1. (jghoman)
+  GIRAPH-122: Roll version back to 0.1. (jghoman)
 
-  GIRAPH-118: Clarify messages behavior in BasicVertex (claudio)
+  GIRAPH-118: Clarify messages behavior in BasicVertex. (claudio)
 
   GIRAPH-119: VertexCombiner should work on Iterable<M> instead of 
   List<M>. (claudio)
diff --git a/src/main/java/org/apache/giraph/graph/LongDoubleFloatDoubleVertex.java b/src/main/java/org/apache/giraph/graph/LongDoubleFloatDoubleVertex.java
index 5fbc369cb..b87573623 100644
--- a/src/main/java/org/apache/giraph/graph/LongDoubleFloatDoubleVertex.java
+++ b/src/main/java/org/apache/giraph/graph/LongDoubleFloatDoubleVertex.java
@@ -134,14 +134,12 @@ public final void sendMsgToAllEdges(final DoubleWritable msg) {
             throw new IllegalArgumentException(
                 "sendMsgToAllEdges: Cannot send null message to all edges");
         }
-        final LongWritable destVertex = new LongWritable();
         final MutableVertex<LongWritable, DoubleWritable, FloatWritable,
             DoubleWritable> vertex = this;
         verticesWithEdgeValues.forEachKey(new LongProcedure() {
             @Override
             public boolean apply(long destVertexId) {
-                destVertex.set(destVertexId);
-                vertex.sendMsg(destVertex, msg);
+                vertex.sendMsg(new LongWritable(destVertexId), msg);
                 return true;
             }
         });
