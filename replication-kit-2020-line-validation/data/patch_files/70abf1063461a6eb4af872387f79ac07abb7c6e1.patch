From 70abf1063461a6eb4af872387f79ac07abb7c6e1 Mon Sep 17 00:00:00 2001
From: Mario Ivankovits <imario@apache.org>
Date: Fri, 6 Oct 2006 05:37:21 +0000
Subject: [PATCH] VFS-93: fixed NPE with urls without password

git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/vfs/trunk@453502 13f79535-47bb-0310-9956-ffa450edef68
---
 .../commons/vfs/provider/sftp/SftpClientFactory.java       | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/java/org/apache/commons/vfs/provider/sftp/SftpClientFactory.java b/src/java/org/apache/commons/vfs/provider/sftp/SftpClientFactory.java
index d0f907519c..772da2b567 100644
--- a/src/java/org/apache/commons/vfs/provider/sftp/SftpClientFactory.java
+++ b/src/java/org/apache/commons/vfs/provider/sftp/SftpClientFactory.java
@@ -131,14 +131,17 @@ public static Session createConnection(String hostname, int port, char[] usernam
             session = jsch.getSession(new String(username),
                     hostname,
                     port);
-            session.setPassword(new String(password));
+            if (password != null)
+            {
+                session.setPassword(new String(password));
+            }
 
             Integer timeout = SftpFileSystemConfigBuilder.getInstance().getTimeout(fileSystemOptions);
             if (timeout != null)
             {
             	session.setTimeout(timeout.intValue());
             }
-            
+
             UserInfo userInfo = SftpFileSystemConfigBuilder.getInstance().getUserInfo(fileSystemOptions);
             if (userInfo != null)
             {
