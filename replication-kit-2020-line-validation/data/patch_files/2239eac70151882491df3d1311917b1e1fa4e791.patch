From 2239eac70151882491df3d1311917b1e1fa4e791 Mon Sep 17 00:00:00 2001
From: "Gary D. Gregory" <ggregory@apache.org>
Date: Sat, 30 Jun 2012 13:21:59 +0000
Subject: [PATCH] Tests https://issues.apache.org/jira/browse/VFS-426 (no
 solution yet)

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/vfs/trunk@1355731 13f79535-47bb-0310-9956-ffa450edef68
---
 .../http/test/HttpFilesCacheTestCase.java     | 58 +++++++++++++++++++
 1 file changed, 58 insertions(+)
 create mode 100644 core/src/test/java/org/apache/commons/vfs2/provider/http/test/HttpFilesCacheTestCase.java

diff --git a/core/src/test/java/org/apache/commons/vfs2/provider/http/test/HttpFilesCacheTestCase.java b/core/src/test/java/org/apache/commons/vfs2/provider/http/test/HttpFilesCacheTestCase.java
new file mode 100644
index 0000000000..fe759f5c27
--- /dev/null
+++ b/core/src/test/java/org/apache/commons/vfs2/provider/http/test/HttpFilesCacheTestCase.java
@@ -0,0 +1,58 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.commons.vfs2.provider.http.test;
+
+import junit.framework.Assert;
+import junit.framework.TestCase;
+
+import org.apache.commons.vfs2.FileObject;
+import org.apache.commons.vfs2.FileSystemException;
+import org.apache.commons.vfs2.FileSystemManager;
+import org.apache.commons.vfs2.VFS;
+import org.junit.Test;
+
+/**
+ * Tests https://issues.apache.org/jira/browse/VFS-426
+ * 
+ * @version $Id$
+ * @since 2.1
+ */
+public class HttpFilesCacheTestCase extends TestCase
+{
+
+    /**
+     * Tests https://issues.apache.org/jira/browse/VFS-426
+     */
+    @Test
+    public void testQueryStringUrls() throws FileSystemException
+    {
+        final String noQueryStringUrl = "http://commons.apache.org/vfs";
+        final String queryStringUrl = "http://commons.apache.org/vfs?query=string";
+        final String queryStringUrl2 = "http://commons.apache.org/vfs?query=string&more=stuff";
+
+        final FileSystemManager fileSystemManager = VFS.getManager();
+
+        final FileObject noQueryFile = fileSystemManager.resolveFile(noQueryStringUrl);
+        Assert.assertEquals(noQueryStringUrl, noQueryFile.getURL().toExternalForm());
+
+        final FileObject queryFile = fileSystemManager.resolveFile(queryStringUrl);
+        // Assert.assertEquals(queryStringUrl, queryFile.getURL().toExternalForm()); // fails for VFS-426
+
+        final FileObject queryFile2 = fileSystemManager.resolveFile(queryStringUrl2);
+        // Assert.assertEquals(queryStringUrl2, queryFile2.getURL().toExternalForm()); // fails for VFS-426
+    }
+}
