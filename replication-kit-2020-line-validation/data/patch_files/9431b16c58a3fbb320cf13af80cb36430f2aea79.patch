From 9431b16c58a3fbb320cf13af80cb36430f2aea79 Mon Sep 17 00:00:00 2001
From: Stefan Bodewig <bodewig@apache.org>
Date: Fri, 5 Feb 2016 20:42:31 +0100
Subject: [PATCH] COMPRESS-334 unit tests with more than one entry

---
 .../compress/archivers/ar/ArArchiveInputStreamTest.java    | 6 ++++++
 src/test/resources/longfile_bsd.ar                         | 2 ++
 src/test/resources/longfile_gnu.ar                         | 7 +++++--
 3 files changed, 13 insertions(+), 2 deletions(-)

diff --git a/src/test/java/org/apache/commons/compress/archivers/ar/ArArchiveInputStreamTest.java b/src/test/java/org/apache/commons/compress/archivers/ar/ArArchiveInputStreamTest.java
index ae09d63c360..d62d3a07f53 100644
--- a/src/test/java/org/apache/commons/compress/archivers/ar/ArArchiveInputStreamTest.java
+++ b/src/test/java/org/apache/commons/compress/archivers/ar/ArArchiveInputStreamTest.java
@@ -51,6 +51,12 @@ private void checkLongNameEntry(String archive) throws Exception {
             byte[] hello = new byte[14];
             s.read(hello);
             assertEquals("Hello, world!\n", ArchiveUtils.toAsciiString(hello));
+            e = s.getNextEntry();
+            assertEquals("this_is_a_long_file_name_as_well.txt", e.getName());
+            assertEquals(4, e.getSize());
+            byte[] bye = new byte[4];
+            s.read(bye);
+            assertEquals("Bye\n", ArchiveUtils.toAsciiString(bye));
             assertNull(s.getNextEntry());
         } finally {
             if (s != null) {
diff --git a/src/test/resources/longfile_bsd.ar b/src/test/resources/longfile_bsd.ar
index 7b0fd513bc2..f7c3682d00f 100644
--- a/src/test/resources/longfile_bsd.ar
+++ b/src/test/resources/longfile_bsd.ar
@@ -1,3 +1,5 @@
 !<arch>
 #1/28           1311256511  1000  1000  100644  42        `
 this_is_a_long_file_name.txtHello, world!
+#1/36           1454694016  1000  1000  100664  40        `
+this_is_a_long_file_name_as_well.txtBye
diff --git a/src/test/resources/longfile_gnu.ar b/src/test/resources/longfile_gnu.ar
index 22d4c0394fc..12799a03354 100644
--- a/src/test/resources/longfile_gnu.ar
+++ b/src/test/resources/longfile_gnu.ar
@@ -1,5 +1,8 @@
 !<arch>
-//                                              30        `
+//                                              68        `
 this_is_a_long_file_name.txt/
-/0              1311256511  1000  1000  100644  14        `
+this_is_a_long_file_name_as_well.txt/
+/0              1454693980  1000  1000  100664  14        `
 Hello, world!
+/30             1454694016  1000  1000  100664  4         `
+Bye
