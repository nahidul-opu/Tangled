From 345b318d84a71e289b8d89c653ef7141dbcabc39 Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Tue, 2 Feb 2010 17:37:31 +0000
Subject: [PATCH] SimpleDateFormat format 'Z' is Java 1.4+ Correct comment and
 test name: LANG-520 => LANG-530

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/lang/branches/LANG_2_X@905721 13f79535-47bb-0310-9956-ffa450edef68
---
 .../commons/lang/time/DateUtilsTest.java       | 18 +++++++++++-------
 1 file changed, 11 insertions(+), 7 deletions(-)

diff --git a/src/test/java/org/apache/commons/lang/time/DateUtilsTest.java b/src/test/java/org/apache/commons/lang/time/DateUtilsTest.java
index 3bda63f6b5e..dffed9ba7ec 100644
--- a/src/test/java/org/apache/commons/lang/time/DateUtilsTest.java
+++ b/src/test/java/org/apache/commons/lang/time/DateUtilsTest.java
@@ -1172,13 +1172,17 @@ public void testTruncateLang59() throws Exception {
         TimeZone.setDefault(defaultZone);
     }
 
-    // http://issues.apache.org/jira/browse/LANG-520
-    public void testLang520() throws ParseException {
-        Date d = new Date();
-        String isoDateStr = DateFormatUtils.ISO_DATETIME_TIME_ZONE_FORMAT.format(d);
-        Date d2 = DateUtils.parseDate(isoDateStr, new String[] { DateFormatUtils.ISO_DATETIME_TIME_ZONE_FORMAT.getPattern() });
-        // the format loses milliseconds so have to reintroduce them
-        assertEquals("Date not equal to itself ISO formatted and parsed", d.getTime(), d2.getTime() + d.getTime() % 1000); 
+    // http://issues.apache.org/jira/browse/LANG-530
+    public void testLang530() throws ParseException {
+        if (SystemUtils.isJavaVersionAtLeast(1.4f)) {
+            Date d = new Date();
+            String isoDateStr = DateFormatUtils.ISO_DATETIME_TIME_ZONE_FORMAT.format(d);
+            Date d2 = DateUtils.parseDate(isoDateStr, new String[] { DateFormatUtils.ISO_DATETIME_TIME_ZONE_FORMAT.getPattern() });
+            // the format loses milliseconds so have to reintroduce them
+            assertEquals("Date not equal to itself ISO formatted and parsed", d.getTime(), d2.getTime() + d.getTime() % 1000);
+        } else {
+            this.warn("WARNING: Cannot test SimpleDateFormat with 'Z' since the current version is " + SystemUtils.JAVA_VERSION);
+        }
     }
     
     /**
