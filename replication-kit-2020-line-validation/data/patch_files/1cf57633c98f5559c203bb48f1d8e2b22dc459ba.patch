From 1cf57633c98f5559c203bb48f1d8e2b22dc459ba Mon Sep 17 00:00:00 2001
From: "Gary D. Gregory" <ggregory@apache.org>
Date: Tue, 19 Sep 2017 19:57:23 +0000
Subject: [PATCH] [VFS-291] ZIP archives are not properly closed after
 unzipping and cannot be deleted until the JVM exists. Do not close underlying
 ZipFile too aggressively; only do so if all open streams are not in use!

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/vfs/trunk@1808939 13f79535-47bb-0310-9956-ffa450edef68
---
 .../commons/vfs2/provider/zip/test/ZipFileObjectTestCase.java  | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/commons-vfs2/src/test/java/org/apache/commons/vfs2/provider/zip/test/ZipFileObjectTestCase.java b/commons-vfs2/src/test/java/org/apache/commons/vfs2/provider/zip/test/ZipFileObjectTestCase.java
index f9250227c8..38509f34b3 100644
--- a/commons-vfs2/src/test/java/org/apache/commons/vfs2/provider/zip/test/ZipFileObjectTestCase.java
+++ b/commons-vfs2/src/test/java/org/apache/commons/vfs2/provider/zip/test/ZipFileObjectTestCase.java
@@ -138,12 +138,11 @@ public void testReadingOneAfterClosingAnotherFile() throws IOException {
 
     /**
      * Tests that we can get a stream from one file in a zip file, then close another file from the same zip, then
-     * process the initial input stream.
+     * process the initial input stream. If our internal reference counting is correct, the test passes.
      *
      * @throws IOException
      */
     @Test
-    @Ignore("Trying to duplicate what I seeing using JAXP")
     public void testReadingOneAfterClosingAnotherStream() throws IOException {
         final File newZipFile = createTempFile();
         final FileSystemManager manager = VFS.getManager();
