From 0d358c9d5e59351a55462e860befd6b6a3dbe535 Mon Sep 17 00:00:00 2001
From: Claudio Martella <claudio@apache.org>
Date: Wed, 12 Jun 2013 19:59:20 +0200
Subject: [PATCH] GIRAPH-686: DiskBackedPartitionStore does not saveVertex
 after edges are loaded

---
 CHANGELOG                                                      | 3 +++
 .../org/apache/giraph/partition/DiskBackedPartitionStore.java  | 1 +
 2 files changed, 4 insertions(+)

diff --git a/CHANGELOG b/CHANGELOG
index f929feb53..50d411a9f 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,9 @@
 Giraph Change Log
 
 Release 1.1.0 - unreleased
+  GIRAPH-686: DiskBackedPartitionStore does not saveVertex after edges 
+  are loaded (claudio)
+
   GIRAPH-681: Graphviz Output Format (nitay)
 
   GIRAPH-468: Make Vertex an Interface (nitay)
diff --git a/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java b/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java
index 059589786..dbfb7916f 100644
--- a/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java
+++ b/giraph-core/src/main/java/org/apache/giraph/partition/DiskBackedPartitionStore.java
@@ -425,6 +425,7 @@ private void readOutEdges(DataInput in, Partition<I, V, E> partition)
     id.readFields(in);
     Vertex<I, V, E> v = partition.getVertex(id);
     ((OutEdges<I, E>) v.getEdges()).readFields(in);
+    partition.saveVertex(v);
   }
 
 
