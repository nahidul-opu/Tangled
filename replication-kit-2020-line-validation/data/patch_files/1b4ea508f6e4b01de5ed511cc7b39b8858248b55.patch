From 1b4ea508f6e4b01de5ed511cc7b39b8858248b55 Mon Sep 17 00:00:00 2001
From: Lewis John McGibbney <lewismc@apache.org>
Date: Wed, 16 May 2012 17:30:47 +0000
Subject: [PATCH] commit to address GORA-63 & 133 respectively and update to
 CHANGES.txt

git-svn-id: https://svn.apache.org/repos/asf/gora/trunk@1339274 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                                   | 2 ++
 bin/compile-examples.sh                                       | 4 ++--
 bin/gora                                                      | 4 ++--
 .../src/main/java/org/apache/gora/compiler/GoraCompiler.java  | 2 +-
 4 files changed, 7 insertions(+), 5 deletions(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index 9f6541fe5..454a83f2d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -6,6 +6,8 @@ Gora Change Log
 
 0.3 (trunk) Current Development:
 
+* GORA-133 & 63 GoraCompiler cannot compile array type & bin/compile-examples.sh does not work respectively (enis, Kazuomi Kashii via lewismc)
+
 * GORA-129 redundant conf field in HBaseStore (ferdy)
 
 * GORA-123 Append correct submodule directories to SCM paths in submodule pom's (lewismc)
diff --git a/bin/compile-examples.sh b/bin/compile-examples.sh
index 979c7f202..57d95adbc 100755
--- a/bin/compile-examples.sh
+++ b/bin/compile-examples.sh
@@ -32,8 +32,8 @@ THIS_DIR=`dirname "$THIS"`
 GORA_HOME=`cd "$THIS_DIR/.." ; pwd`
 
 MODULE=gora-core
-DIR=$MODULE/src/examples/avro/
-OUTDIR=$MODULE/src/examples/java
+DIR=$GORA_HOME/$MODULE/src/examples/avro/
+OUTDIR=$GORA_HOME/$MODULE/src/examples/java
 GORA_BIN=$GORA_HOME/bin/gora
 
 for f in `ls $DIR` ; do
diff --git a/bin/gora b/bin/gora
index f69dc48cf..3836ee284 100755
--- a/bin/gora
+++ b/bin/gora
@@ -137,8 +137,8 @@ for f in $GORA_HOME/$MODULE/build/*.job; do
   CLASSPATH=${CLASSPATH}:$f;
 done
 
-CLASSPATH=$CLASSPATH:$GORA_HOME/$MODULE/build/classes
-CLASSPATH=${CLASSPATH}:$GORA_HOME/$MODULE/build/test/classes
+CLASSPATH=$CLASSPATH:$GORA_HOME/$MODULE/target/classes
+CLASSPATH=${CLASSPATH}:$GORA_HOME/$MODULE/target/test/classes
 
 CLASSPATH=$CLASSPATH:$GORA_HOME/conf
 CLASSPATH=$CLASSPATH:$GORA_HOME/$MODULE/conf
diff --git a/gora-core/src/main/java/org/apache/gora/compiler/GoraCompiler.java b/gora-core/src/main/java/org/apache/gora/compiler/GoraCompiler.java
index cf0ca837f..ec1e53d83 100644
--- a/gora-core/src/main/java/org/apache/gora/compiler/GoraCompiler.java
+++ b/gora-core/src/main/java/org/apache/gora/compiler/GoraCompiler.java
@@ -324,7 +324,7 @@ private void compile(Schema schema) throws IOException {
             break;
           case ARRAY:
             unboxed = unbox(fieldSchema.getElementType());
-            fieldType = type(fieldSchema.getValueType());
+            fieldType = type(fieldSchema.getElementType());
             line(1, "public GenericArray<"+fieldType+"> get"+camelKey+"() {");
             line(2, "return (GenericArray<"+fieldType+">) get("+i+");");
             line(1, "}");
