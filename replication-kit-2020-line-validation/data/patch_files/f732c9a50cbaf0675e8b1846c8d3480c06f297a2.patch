From f732c9a50cbaf0675e8b1846c8d3480c06f297a2 Mon Sep 17 00:00:00 2001
From: Stephen Colebourne <scolebourne@apache.org>
Date: Tue, 5 Dec 2006 00:12:58 +0000
Subject: [PATCH] IO-100 - FileUtils.touch now throws an exception if it fails

git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/io/trunk@482423 13f79535-47bb-0310-9956-ffa450edef68
---
 RELEASE-NOTES.txt                             | 6 ++++++
 src/java/org/apache/commons/io/FileUtils.java | 5 ++++-
 2 files changed, 10 insertions(+), 1 deletion(-)

diff --git a/RELEASE-NOTES.txt b/RELEASE-NOTES.txt
index 5c0c74c5178..6ab2840ce76 100644
--- a/RELEASE-NOTES.txt
+++ b/RELEASE-NOTES.txt
@@ -22,6 +22,7 @@ Binary compatible - Yes
 Source compatible - Yes
 
 Semantic compatible - Yes
+  Check the bug fixes section for semantic bug fixes
 
 
 Deprecations from 1.2
@@ -56,6 +57,11 @@ Bug fixes from 1.2
   - Previously did not destroy Process instances (as JDK Javadoc is so poor)
   - http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4801027
 
+- FileUtils.touch [IO-100]
+  - The touch method previously gave no indication when the file could not
+    be touched successfully (such as due to access restrictions) - it now
+    throws an IOException if the last modified date cannot be changed
+
 - FileCleaner
   - This now handles the situation where an error occurs when deleting the file
 
diff --git a/src/java/org/apache/commons/io/FileUtils.java b/src/java/org/apache/commons/io/FileUtils.java
index 2d96b44658b..bc7d9fb6369 100644
--- a/src/java/org/apache/commons/io/FileUtils.java
+++ b/src/java/org/apache/commons/io/FileUtils.java
@@ -133,6 +133,9 @@ public static String byteCountToDisplaySize(long size) {
      * Implements the same behaviour as the "touch" utility on Unix. It creates
      * a new file with size 0 or, if the file exists already, it is opened and
      * closed without modifying it, but updating the file date and time.
+     * <p>
+     * NOTE: As from v1.3, this method throws an IOException if the last
+     * modified date of the file cannot be set
      *
      * @param file  the File to touch
      * @throws IOException If an I/O problem occurs
@@ -143,7 +146,7 @@ public static void touch(File file) throws IOException {
             IOUtils.closeQuietly(out);
         }
         boolean success = file.setLastModified(System.currentTimeMillis());
-        if(!success) {
+        if (!success) {
             throw new IOException("Unable to set the last modification time for " + file);
         }
     }
