From fb2067db8ce0ad5faa42d00b989a3ab09201c689 Mon Sep 17 00:00:00 2001
From: Colm O Heigeartaigh <coheigea@apache.org>
Date: Tue, 26 Apr 2011 09:33:55 +0000
Subject: [PATCH] [SANTUARIO-266] - c14n11 produces different signatures using
 version 1.4.3 and 1.4.4

git-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1096704 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGELOG.txt                                                   | 1 +
 .../xml/security/c14n/implementations/Canonicalizer11.java      | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG.txt b/CHANGELOG.txt
index 82467471da..b35563a860 100644
--- a/CHANGELOG.txt
+++ b/CHANGELOG.txt
@@ -1,6 +1,7 @@
 Changelog for "Apache xml-security" <http://santuario.apache.org/>
 
 New in v1.5.0-SNAPSHOT
+    Fixed SANTUARIO-266: c14n11 produces different signatures using version 1.4.3 and 1.4.4.
     Fixed SANTUARIO-254: Rework org.apache.xml.security.utils.resolver.ResourceResolver.
     Fixed SANTUARIO-263: Canonicalizer can't handle dynamical created DOM correctly. Thanks to Martin Koegler.
     Fixed SANTUARIO-262: Invalid use of String.getBytes(). Thanks to Martin Koegler.
diff --git a/src/main/java/org/apache/xml/security/c14n/implementations/Canonicalizer11.java b/src/main/java/org/apache/xml/security/c14n/implementations/Canonicalizer11.java
index 69f3455096..b615f45b2d 100644
--- a/src/main/java/org/apache/xml/security/c14n/implementations/Canonicalizer11.java
+++ b/src/main/java/org/apache/xml/security/c14n/implementations/Canonicalizer11.java
@@ -431,7 +431,7 @@ protected void handleParent(Element e, NameSpaceSymbTable ns) {
             Attr N = (Attr) attrs.item(i);
             if (!Constants.NamespaceSpecNS.equals(N.getNamespaceURI())) {
                 // Not a namespace definition, ignore.
-                if (!XML_LANG_URI.equals(N.getNamespaceURI())) {
+                if (XML_LANG_URI.equals(N.getNamespaceURI())) {
                     xmlattrStack.addXmlnsAttr(N);
                 }
                 continue;
