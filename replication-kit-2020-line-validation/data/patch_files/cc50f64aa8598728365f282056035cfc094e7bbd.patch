From cc50f64aa8598728365f282056035cfc094e7bbd Mon Sep 17 00:00:00 2001
From: "Gary D. Gregory" <ggregory@apache.org>
Date: Wed, 1 Jun 2016 04:46:44 +0000
Subject: [PATCH] [BCEL-271] FCONST pattern does not include FCONST_2.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/bcel/trunk@1746383 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                         | 1 +
 .../java/org/apache/commons/bcel6/util/InstructionFinder.java   | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index fb8d531ea9..b36c7e35cd 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -63,6 +63,7 @@ The <action> type attribute can be add,update,fix,remove.
 
   <body>
     <release version="6.0" date="TBA" description="Major release with Java 7 and 8 support">
+      <action issue="BCEL-271" type="fix">FCONST pattern does not include FCONST_2</action>
       <action issue="BCEL-264" type="fix">Add missing Node.accept() implementations (ConstantMethodHandle, ConstantMethodType, ParameterAnnotationEntry)</action>
       <action issue="BCEL-221" type="fix">BCELifier is not working for Java8Example (incomplete)</action>
       <action issue="BCEL-195" type="fix">addition of hashCode() to generic/Instruction.java breaks Targeters. Never make distinct BranchInstructions compare equal</action>
diff --git a/src/main/java/org/apache/commons/bcel6/util/InstructionFinder.java b/src/main/java/org/apache/commons/bcel6/util/InstructionFinder.java
index 03df2e6386..4fb9b92f30 100644
--- a/src/main/java/org/apache/commons/bcel6/util/InstructionFinder.java
+++ b/src/main/java/org/apache/commons/bcel6/util/InstructionFinder.java
@@ -346,7 +346,7 @@ public static interface CodeConstraint {
         map.put("iconst", precompile(Const.ICONST_0, Const.ICONST_5, Const.ICONST_M1));
         map.put("lconst", new String(new char[] { '(', makeChar(Const.LCONST_0), '|', makeChar(Const.LCONST_1), ')' }));
         map.put("dconst", new String(new char[] { '(', makeChar(Const.DCONST_0), '|', makeChar(Const.DCONST_1), ')' }));
-        map.put("fconst", new String(new char[] { '(', makeChar(Const.FCONST_0), '|', makeChar(Const.FCONST_1), ')' }));
+        map.put("fconst", new String(new char[] { '(', makeChar(Const.FCONST_0), '|', makeChar(Const.FCONST_1), '|', makeChar(Const.FCONST_2), ')' }));
         map.put("lload", precompile(Const.LLOAD_0, Const.LLOAD_3, Const.LLOAD));
         map.put("iload", precompile(Const.ILOAD_0, Const.ILOAD_3, Const.ILOAD));
         map.put("dload", precompile(Const.DLOAD_0, Const.DLOAD_3, Const.DLOAD));
