From 6e245f214c938296295e88ae6dc3d02ad9cefae4 Mon Sep 17 00:00:00 2001
From: Colm O hEigeartaigh <coheigea@apache.org>
Date: Fri, 5 Jan 2018 16:16:33 +0000
Subject: [PATCH] SANTUARIO-481 - JCEMapper returning keysizes for HMAC
 Algorithms

git-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/trunk@1820316 13f79535-47bb-0310-9956-ffa450edef68
---
 .../apache/xml/security/algorithms/JCEMapper.java  | 14 +++++++-------
 .../org/apache/xml/security/resource/config.xml    | 14 +++++++-------
 src/main/resources/security-config.xml             | 14 +++++++-------
 3 files changed, 21 insertions(+), 21 deletions(-)

diff --git a/src/main/java/org/apache/xml/security/algorithms/JCEMapper.java b/src/main/java/org/apache/xml/security/algorithms/JCEMapper.java
index 94c046a134..878f37d0bc 100644
--- a/src/main/java/org/apache/xml/security/algorithms/JCEMapper.java
+++ b/src/main/java/org/apache/xml/security/algorithms/JCEMapper.java
@@ -205,31 +205,31 @@ public static void registerDefaultAlgorithms() {
         );
         algorithmsMap.put(
             XMLSignature.ALGO_ID_MAC_HMAC_NOT_RECOMMENDED_MD5,
-            new Algorithm("", "HmacMD5", "Mac", 128, 0)
+            new Algorithm("", "HmacMD5", "Mac", 0, 0)
         );
         algorithmsMap.put(
             XMLSignature.ALGO_ID_MAC_HMAC_RIPEMD160,
-            new Algorithm("", "HMACRIPEMD160", "Mac", 160, 0)
+            new Algorithm("", "HMACRIPEMD160", "Mac", 0, 0)
         );
         algorithmsMap.put(
             XMLSignature.ALGO_ID_MAC_HMAC_SHA1,
-            new Algorithm("", "HmacSHA1", "Mac", 160, 0)
+            new Algorithm("", "HmacSHA1", "Mac", 0, 0)
         );
         algorithmsMap.put(
             XMLSignature.ALGO_ID_MAC_HMAC_SHA224,
-            new Algorithm("", "HmacSHA224", "Mac", 224, 0)
+            new Algorithm("", "HmacSHA224", "Mac", 0, 0)
         );
         algorithmsMap.put(
             XMLSignature.ALGO_ID_MAC_HMAC_SHA256,
-            new Algorithm("", "HmacSHA256", "Mac", 256, 0)
+            new Algorithm("", "HmacSHA256", "Mac", 0, 0)
         );
         algorithmsMap.put(
             XMLSignature.ALGO_ID_MAC_HMAC_SHA384,
-            new Algorithm("", "HmacSHA384", "Mac", 384, 0)
+            new Algorithm("", "HmacSHA384", "Mac", 0, 0)
         );
         algorithmsMap.put(
             XMLSignature.ALGO_ID_MAC_HMAC_SHA512,
-            new Algorithm("", "HmacSHA512", "Mac", 512, 0)
+            new Algorithm("", "HmacSHA512", "Mac", 0, 0)
         );
         // Encryption algorithms
         algorithmsMap.put(
diff --git a/src/main/java/org/apache/xml/security/resource/config.xml b/src/main/java/org/apache/xml/security/resource/config.xml
index 5b22c72cac..14644f3a92 100644
--- a/src/main/java/org/apache/xml/security/resource/config.xml
+++ b/src/main/java/org/apache/xml/security/resource/config.xml
@@ -373,7 +373,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="NOT RECOMMENDED"
                     SpecificationURL="http://www.ietf.org/rfc/rfc4051.txt"
-                    KeyLength="128"
+                    KeyLength="0"
                     JCEName="HmacMD5"/>
 
          <Algorithm URI="http://www.w3.org/2001/04/xmldsig-more#hmac-ripemd160"
@@ -381,14 +381,14 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/rfc/rfc4051.txt"
-                    KeyLength="160"
+                    KeyLength="0"
                     JCEName="HMACRIPEMD160"/>
 
          <Algorithm URI="http://www.w3.org/2000/09/xmldsig#hmac-sha1"
                     Description="Message Authentication code using SHA1"
                     AlgorithmClass="Mac"
                     RequirementLevel="REQUIRED"
-                    KeyLength="160"
+                    KeyLength="0"
                     JCEName="HmacSHA1"/>
                     
          <Algorithm URI="http://www.w3.org/2001/04/xmldsig-more#hmac-sha224"
@@ -396,7 +396,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/rfc/rfc4051.txt"
-                    KeyLength="224"
+                    KeyLength="0"
                     JCEName="HmacSHA224"/>
 
          <Algorithm URI="http://www.w3.org/2001/04/xmldsig-more#hmac-sha256"
@@ -404,7 +404,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/rfc/rfc4051.txt"
-                    KeyLength="256"
+                    KeyLength="0"
                     JCEName="HmacSHA256"/>
 
          <Algorithm URI="http://www.w3.org/2001/04/xmldsig-more#hmac-sha384"
@@ -412,7 +412,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/rfc/rfc4051.txt"
-                    KeyLength="384"
+                    KeyLength="0"
                     JCEName="HmacSHA384"/>
 
          <Algorithm URI="http://www.w3.org/2001/04/xmldsig-more#hmac-sha512"
@@ -420,7 +420,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/rfc/rfc4051.txt"
-                    KeyLength="512"
+                    KeyLength="0"
                     JCEName="HmacSHA512"/>
 
          <!-- Block encryption Algorithms -->
diff --git a/src/main/resources/security-config.xml b/src/main/resources/security-config.xml
index 0e54343c1f..e20b365d84 100644
--- a/src/main/resources/security-config.xml
+++ b/src/main/resources/security-config.xml
@@ -349,7 +349,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="NOT RECOMMENDED"
                     SpecificationURL="http://www.ietf.org/internet-drafts/draft-eastlake-xmldsig-uri-02.txt"
-                    KeyLength="128"
+                    KeyLength="0"
                     RequiredKey="HmacMD5"
                     JCEName="HmacMD5"/>
 
@@ -358,7 +358,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/internet-drafts/draft-eastlake-xmldsig-uri-02.txt"
-                    KeyLength="160"
+                    KeyLength="0"
                     RequiredKey="HMACRIPEMD160"
                     JCEName="HMACRIPEMD160"/>
 
@@ -366,7 +366,7 @@
                     Description="Message Authentication code using SHA1"
                     AlgorithmClass="Mac"
                     RequirementLevel="REQUIRED"
-                    KeyLength="160"
+                    KeyLength="0"
                     RequiredKey="HmacSHA1"
                     JCEName="HmacSHA1"/>
 
@@ -374,7 +374,7 @@
                     Description="Message Authentication code using SHA-224"
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
-                    KeyLength="224"
+                    KeyLength="0"
                     RequiredKey="HmacSHA224"
                     JCEName="HmacSHA224"/>
                     
@@ -383,7 +383,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/internet-drafts/draft-eastlake-xmldsig-uri-02.txt"
-                    KeyLength="256"
+                    KeyLength="0"
                     RequiredKey="HmacSHA256"
                     JCEName="HmacSHA256"/>
 
@@ -392,7 +392,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/internet-drafts/draft-eastlake-xmldsig-uri-02.txt"
-                    KeyLength="384"
+                    KeyLength="0"
                     RequiredKey="HmacSHA384"
                     JCEName="HmacSHA384"/>
 
@@ -401,7 +401,7 @@
                     AlgorithmClass="Mac"
                     RequirementLevel="OPTIONAL"
                     SpecificationURL="http://www.ietf.org/internet-drafts/draft-eastlake-xmldsig-uri-02.txt"
-                    KeyLength="512"
+                    KeyLength="0"
                     RequiredKey="HmacSHA512"
                     JCEName="HmacSHA512"/>
 
