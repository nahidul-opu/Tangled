From 82c95c5f951ec316a717d72a46e9f1f7792dc818 Mon Sep 17 00:00:00 2001
From: Romain Manni-Bucau <rmannibucau@apache.org>
Date: Fri, 9 Jun 2017 10:32:57 +0000
Subject: [PATCH] JCS-178 fixing RemoteCacheNoWaitFacade constructor logic

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/jcs/trunk@1798187 13f79535-47bb-0310-9956-ffa450edef68
---
 .../commons/jcs/auxiliary/remote/RemoteCacheNoWaitFacade.java  | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/commons-jcs-core/src/main/java/org/apache/commons/jcs/auxiliary/remote/RemoteCacheNoWaitFacade.java b/commons-jcs-core/src/main/java/org/apache/commons/jcs/auxiliary/remote/RemoteCacheNoWaitFacade.java
index 51333ce70..7276cc5a0 100644
--- a/commons-jcs-core/src/main/java/org/apache/commons/jcs/auxiliary/remote/RemoteCacheNoWaitFacade.java
+++ b/commons-jcs-core/src/main/java/org/apache/commons/jcs/auxiliary/remote/RemoteCacheNoWaitFacade.java
@@ -19,6 +19,7 @@
  * under the License.
  */
 
+import java.util.ArrayList;
 import java.util.List;
 
 import org.apache.commons.jcs.auxiliary.remote.server.behavior.RemoteType;
@@ -67,7 +68,7 @@ public RemoteCacheNoWaitFacade( List<ICache<K, V>> noWaits,
         super( noWaits, rca, cacheMgr, cacheEventLogger, elementSerializer );
         this.cacheFactory = cacheFactory;
 
-        for (RemoteCacheNoWait<K,V> rcnw : this.noWaits)
+        for (RemoteCacheNoWait<K,V> rcnw : new ArrayList<RemoteCacheNoWait<K, V>>(this.noWaits))
         {
             ((RemoteCache<K, V>)rcnw.getRemoteCache()).setFacade(this);
             this.noWaits.add(rcnw);
