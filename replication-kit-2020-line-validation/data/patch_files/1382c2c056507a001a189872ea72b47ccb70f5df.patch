From 1382c2c056507a001a189872ea72b47ccb70f5df Mon Sep 17 00:00:00 2001
From: Rory Winston <rwinston@apache.org>
Date: Mon, 8 Mar 2010 10:17:43 +0000
Subject: [PATCH] Fix and test case for NET-290

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/branches/NET_2_0@920258 13f79535-47bb-0310-9956-ffa450edef68
---
 .../org/apache/commons/net/io/DotTerminatedMessageReader.java  | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/main/java/org/apache/commons/net/io/DotTerminatedMessageReader.java b/src/main/java/org/apache/commons/net/io/DotTerminatedMessageReader.java
index c521ec1e7..99b800012 100644
--- a/src/main/java/org/apache/commons/net/io/DotTerminatedMessageReader.java
+++ b/src/main/java/org/apache/commons/net/io/DotTerminatedMessageReader.java
@@ -158,6 +158,9 @@ public int read() throws IOException
                                      LS_CHARS.length);
                     ch = internalBuffer[pos++];
                 }
+                else if (ch == '\r') {
+                	internalReader.unread(ch);
+                }
                 else
                 {
                     internalBuffer[--pos] = (char) ch;
