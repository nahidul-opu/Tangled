From eab37d86220586067c468d2b31540ecd71ca275a Mon Sep 17 00:00:00 2001
From: Colm O Heigeartaigh <coheigea@apache.org>
Date: Tue, 26 Apr 2011 09:21:58 +0000
Subject: [PATCH] [SANTUARIO-266] - c14n11 produces different signatures using
 version 1.4.3 and 1.4.4

git-svn-id: https://svn.apache.org/repos/asf/santuario/xml-security-java/branches/1.4.x-fixes@1096703 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGELOG.txt                                                   | 1 +
 .../xml/security/c14n/implementations/Canonicalizer11.java      | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG.txt b/CHANGELOG.txt
index 0f4c4e2753..bb8fe01d7a 100644
--- a/CHANGELOG.txt
+++ b/CHANGELOG.txt
@@ -1,5 +1,6 @@
 Changelog for "Apache xml-security" <http://santuario.apache.org/>
 New in v1.4.5-SNAPSHOT
+    Fixed SANTUARIO-266: c14n11 produces different signatures using version 1.4.3 and 1.4.4.
     Fixed SANTUARIO-253: org.apache.xml.security.utils.resolver.ResourceResolver is not thread safe.
     Fixed SANTUARIO-263: Canonicalizer can't handle dynamical created DOM correctly. Thanks to Martin Koegler.
     Fixed SANTUARIO-262: Invalid use of String.getBytes(). Thanks to Martin Koegler.
diff --git a/src/org/apache/xml/security/c14n/implementations/Canonicalizer11.java b/src/org/apache/xml/security/c14n/implementations/Canonicalizer11.java
index 530f285afe..3213b58fa2 100644
--- a/src/org/apache/xml/security/c14n/implementations/Canonicalizer11.java
+++ b/src/org/apache/xml/security/c14n/implementations/Canonicalizer11.java
@@ -422,7 +422,7 @@ void handleParent(Element e, NameSpaceSymbTable ns) {
 	    Attr N = (Attr) attrs.item(i);
 	    if (!Constants.NamespaceSpecNS.equals(N.getNamespaceURI())) {
 		// Not a namespace definition, ignore.
-		if (!XML_LANG_URI.equals(N.getNamespaceURI())) {
+		if (XML_LANG_URI.equals(N.getNamespaceURI())) {
 		    xmlattrStack.addXmlnsAttr(N);
 		}
 		continue;
