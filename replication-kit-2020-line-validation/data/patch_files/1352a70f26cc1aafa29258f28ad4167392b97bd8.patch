From 1352a70f26cc1aafa29258f28ad4167392b97bd8 Mon Sep 17 00:00:00 2001
From: Phil Steitz <psteitz@apache.org>
Date: Sun, 11 Dec 2011 21:58:50 +0000
Subject: [PATCH] Made ISAACRandom clear its normal deviate cache on reseed.
 JIRA: MATH-723.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/math/trunk@1213087 13f79535-47bb-0310-9956-ffa450edef68
---
 .../java/org/apache/commons/math/random/ISAACRandom.java   | 1 +
 .../java/org/apache/commons/math/random/ISAACTest.java     | 7 ++++++-
 2 files changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/main/java/org/apache/commons/math/random/ISAACRandom.java b/src/main/java/org/apache/commons/math/random/ISAACRandom.java
index 3db6de1be3..011a704541 100644
--- a/src/main/java/org/apache/commons/math/random/ISAACRandom.java
+++ b/src/main/java/org/apache/commons/math/random/ISAACRandom.java
@@ -235,6 +235,7 @@ private void initState() {
         }
         isaac();
         count = SIZE - 1;
+        clear();
     }
 
     /** Shuffle array. */
diff --git a/src/test/java/org/apache/commons/math/random/ISAACTest.java b/src/test/java/org/apache/commons/math/random/ISAACTest.java
index aadbc67e8e..61eeb4fff3 100644
--- a/src/test/java/org/apache/commons/math/random/ISAACTest.java
+++ b/src/test/java/org/apache/commons/math/random/ISAACTest.java
@@ -20,7 +20,12 @@
 import org.junit.Assert;
 import org.junit.Test;
 
-public final class ISAACTest {
+public final class ISAACTest extends RandomGeneratorAbstractTest {
+
+    @Override
+    protected RandomGenerator makeGenerator() {
+        return new ISAACRandom(1000);
+    }
 
     private static final int[] SEED_1 = {
             0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000, 0x00000000,
