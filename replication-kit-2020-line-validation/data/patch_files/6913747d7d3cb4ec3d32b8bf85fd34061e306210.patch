From 6913747d7d3cb4ec3d32b8bf85fd34061e306210 Mon Sep 17 00:00:00 2001
From: Henri Yandell <bayard@apache.org>
Date: Sat, 16 Jan 2010 19:50:33 +0000
Subject: [PATCH] Modifying toString method to cache in a thread-safe way per
 LANG-481

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/lang/trunk@900015 13f79535-47bb-0310-9956-ffa450edef68
---
 src/main/java/org/apache/commons/lang3/Range.java | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/src/main/java/org/apache/commons/lang3/Range.java b/src/main/java/org/apache/commons/lang3/Range.java
index 9344f980b58..7b20ca3c683 100644
--- a/src/main/java/org/apache/commons/lang3/Range.java
+++ b/src/main/java/org/apache/commons/lang3/Range.java
@@ -350,16 +350,18 @@ public int hashCode() {
      */
     @Override
     public String toString() {
-        if (toString == null) {
+        String result = toString;
+        if (result == null) {
             StringBuilder buf = new StringBuilder(32);
             buf.append("Range[");
             buf.append(this.minimum);
             buf.append(',');
             buf.append(this.maximum);
             buf.append(']');
-            toString = buf.toString();
+            result = buf.toString();
+            toString = result;
         }
-        return toString;
+        return result;
     }
 
     // Taken from Commons Collections - documentation removed as not a public class
