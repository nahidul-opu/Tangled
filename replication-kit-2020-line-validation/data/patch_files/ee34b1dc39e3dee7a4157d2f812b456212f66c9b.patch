From ee34b1dc39e3dee7a4157d2f812b456212f66c9b Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Sun, 27 Feb 2011 03:28:50 +0000
Subject: [PATCH] NET-289 StackOverflowError in Threader

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/trunk@1074982 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                 | 3 +++
 src/main/java/org/apache/commons/net/nntp/Threader.java | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 4738f493d..6e23c42da 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -54,6 +54,9 @@ The <action> type attribute can be add,update,fix,remove.
 
     <body>
         <release version="3.0" date="TBA" description="TBA">
+            <action issue="NET-289" dev="sebb" type="fix" due-to="Luc Claes">
+            StackOverflowError in Threader.
+            </action>
             <action issue="NET-317" dev="sebb" type="fix">
             POP3MessageInfo fields should be final.
             </action>
diff --git a/src/main/java/org/apache/commons/net/nntp/Threader.java b/src/main/java/org/apache/commons/net/nntp/Threader.java
index e626d0efb..0763eded1 100644
--- a/src/main/java/org/apache/commons/net/nntp/Threader.java
+++ b/src/main/java/org/apache/commons/net/nntp/Threader.java
@@ -141,7 +141,7 @@ private void buildContainer(Threadable threadable) {
                 if ((parentRef != null)
                     && (ref.parent == null)
                     && (parentRef != ref)
-                    && !(parentRef.findChild(ref))) {
+                    && !(ref.findChild(parentRef))) {
                     // Link ref into the parent's child list
                     ref.parent = parentRef;
                     ref.next = parentRef.child;
