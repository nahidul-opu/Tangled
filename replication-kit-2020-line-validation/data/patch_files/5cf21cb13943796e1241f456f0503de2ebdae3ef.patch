From 5cf21cb13943796e1241f456f0503de2ebdae3ef Mon Sep 17 00:00:00 2001
From: Scokart Gilles <gscokart@apache.org>
Date: Mon, 8 Oct 2007 12:54:44 +0000
Subject: [PATCH] IVY-618 : fix NPE when the module is evicted and the
 dependency descriptor is null

git-svn-id: https://svn.apache.org/repos/asf/incubator/ivy/core/trunk@582811 13f79535-47bb-0310-9956-ffa450edef68
---
 src/java/org/apache/ivy/core/resolve/ResolveEngine.java | 7 ++-----
 1 file changed, 2 insertions(+), 5 deletions(-)

diff --git a/src/java/org/apache/ivy/core/resolve/ResolveEngine.java b/src/java/org/apache/ivy/core/resolve/ResolveEngine.java
index 7968c97cf..d7d0b03b0 100644
--- a/src/java/org/apache/ivy/core/resolve/ResolveEngine.java
+++ b/src/java/org/apache/ivy/core/resolve/ResolveEngine.java
@@ -257,16 +257,13 @@ public ResolveReport resolve(ModuleDescriptor md, ResolveOptions options)
                                 throw new NullPointerException("getResolvedId() is null for " 
                                     + dependencies[i].toString());
                             }
-                            if (depDescriptor == null) {
-                                throw new NullPointerException("getDescriptor() is null for " 
-                                    + dependencies[i].toString());
-                            }
                             if (depRevisionId == null) {
                                 throw new NullPointerException("getDependencyRevisionId() "
                                     + "is null for " + dd.toString());
                             }
                             String rev = depResolvedId.getRevision();
-                            String status = depDescriptor.getStatus();
+                            //The evicted modules have no descritpion, so we can't put their status. 
+                            String status = depDescriptor==null ? "?" : depDescriptor.getStatus();
                             props.put(depRevisionId.encodeToString(), rev + " " + status);
                         }
                     }
