From 83a0723080b79d6009019db2780b62bc46b4de6f Mon Sep 17 00:00:00 2001
From: "Gary D. Gregory" <ggregory@apache.org>
Date: Thu, 10 Jan 2013 14:17:46 +0000
Subject: [PATCH] [VFS-450] HDFSFileSystem.resolveFile() does not honor
 CacheStrategy.ON_RESOLVE.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/vfs/trunk@1431376 13f79535-47bb-0310-9956-ffa450edef68
---
 .../commons/vfs2/provider/hdfs/HdfsFileSystem.java | 14 +++++++-------
 src/changes/changes.xml                            |  4 ++--
 2 files changed, 9 insertions(+), 9 deletions(-)

diff --git a/core/src/main/java/org/apache/commons/vfs2/provider/hdfs/HdfsFileSystem.java b/core/src/main/java/org/apache/commons/vfs2/provider/hdfs/HdfsFileSystem.java
index 2a33e13ca7..9b961fb0d2 100644
--- a/core/src/main/java/org/apache/commons/vfs2/provider/hdfs/HdfsFileSystem.java
+++ b/core/src/main/java/org/apache/commons/vfs2/provider/hdfs/HdfsFileSystem.java
@@ -149,13 +149,13 @@ public FileObject resolveFile(final FileName name) throws FileSystemException
             {
         	this.putFileToCache(file);
             }
-            /**
-             * resync the file information if requested
-             */
-            if (getFileSystemManager().getCacheStrategy().equals(CacheStrategy.ON_RESOLVE))
-            {
-                file.refresh();
-            }
+        }
+        /**
+         * resync the file information if requested
+         */
+        if (getFileSystemManager().getCacheStrategy().equals(CacheStrategy.ON_RESOLVE))
+        {
+            file.refresh();
         }
         return file;
     }
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 83aed3ab61..fff9db048b 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -26,8 +26,8 @@
 <!--       <action issue="VFS-443" dev="ggregory" type="update" due-to="nickallen"> -->
 <!--     	[Local] Need an easy way to convert from a FileObject to a File. -->
 <!--       </action> -->
-      <action issue="VFS-449" dev="ggregory" type="fix" due-to="dlmarion">
-        HDFS Provider is not removing cached files.
+      <action issue="VFS-450" dev="ggregory" type="fix" due-to="dlmarion">
+        HDFSFileSystem.resolveFile() does not honor CacheStrategy.ON_RESOLVE.
       </action>
       <action issue="VFS-442" dev="ggregory" type="add" due-to="dlmarion">
         Add an HDFS FileSystem Provider.
