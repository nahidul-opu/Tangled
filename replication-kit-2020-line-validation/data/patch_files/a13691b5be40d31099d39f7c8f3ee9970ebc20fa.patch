From a13691b5be40d31099d39f7c8f3ee9970ebc20fa Mon Sep 17 00:00:00 2001
From: thygesen <thygesen@apache.org>
Date: Mon, 29 May 2017 16:07:35 +0200
Subject: [PATCH] OPENNLP-1081: Fix Dictionary support to
 GeneratorFactory::extractArtifactSerializerMappings

closes #220
---
 .../util/featuregen/GeneratorFactory.java     |  5 +++++
 .../util/featuregen/GeneratorFactoryTest.java | 13 +++++++++++
 ...stDictionarySerializerMappingExtractionxml | 22 +++++++++++++++++++
 3 files changed, 40 insertions(+)
 create mode 100644 opennlp-tools/src/test/resources/opennlp/tools/util/featuregen/TestDictionarySerializerMappingExtractionxml

diff --git a/opennlp-tools/src/main/java/opennlp/tools/util/featuregen/GeneratorFactory.java b/opennlp-tools/src/main/java/opennlp/tools/util/featuregen/GeneratorFactory.java
index 11cad423a..4c3e48f2e 100644
--- a/opennlp-tools/src/main/java/opennlp/tools/util/featuregen/GeneratorFactory.java
+++ b/opennlp-tools/src/main/java/opennlp/tools/util/featuregen/GeneratorFactory.java
@@ -47,6 +47,7 @@
 import opennlp.tools.util.InvalidFormatException;
 import opennlp.tools.util.ext.ExtensionLoader;
 import opennlp.tools.util.model.ArtifactSerializer;
+import opennlp.tools.util.model.DictionarySerializer;
 import opennlp.tools.util.model.POSModelSerializer;
 
 /**
@@ -845,6 +846,10 @@ public static Map<String, ArtifactSerializer<?>> extractArtifactSerializerMappin
             case "brownclusterbigram": //, ;
               mapping.put(dictName, new BrownCluster.BrownClusterSerializer());
               break;
+
+            case "dictionary":
+              mapping.put(dictName, new DictionarySerializer());
+              break;
           }
         }
 
diff --git a/opennlp-tools/src/test/java/opennlp/tools/util/featuregen/GeneratorFactoryTest.java b/opennlp-tools/src/test/java/opennlp/tools/util/featuregen/GeneratorFactoryTest.java
index dd569b071..740553719 100644
--- a/opennlp-tools/src/test/java/opennlp/tools/util/featuregen/GeneratorFactoryTest.java
+++ b/opennlp-tools/src/test/java/opennlp/tools/util/featuregen/GeneratorFactoryTest.java
@@ -29,6 +29,7 @@
 import opennlp.tools.util.InvalidFormatException;
 import opennlp.tools.util.featuregen.WordClusterDictionary.WordClusterDictionarySerializer;
 import opennlp.tools.util.model.ArtifactSerializer;
+import opennlp.tools.util.model.DictionarySerializer;
 
 public class GeneratorFactoryTest {
 
@@ -124,4 +125,16 @@ public void testArtifactToSerializerMappingExtraction() throws IOException {
 
     Assert.assertTrue(mapping.get("test.resource") instanceof WordClusterDictionarySerializer);
   }
+
+  @Test
+  public void testDictionaryArtifactToSerializerMappingExtraction() throws IOException {
+
+    InputStream descIn = getClass().getResourceAsStream(
+            "/opennlp/tools/util/featuregen/TestDictionarySerializerMappingExtractionxml");
+
+    Map<String, ArtifactSerializer<?>> mapping =
+            GeneratorFactory.extractArtifactSerializerMappings(descIn);
+
+    Assert.assertTrue(mapping.get("test.dictionary") instanceof DictionarySerializer);
+  }
 }
diff --git a/opennlp-tools/src/test/resources/opennlp/tools/util/featuregen/TestDictionarySerializerMappingExtractionxml b/opennlp-tools/src/test/resources/opennlp/tools/util/featuregen/TestDictionarySerializerMappingExtractionxml
new file mode 100644
index 000000000..334fd3f31
--- /dev/null
+++ b/opennlp-tools/src/test/resources/opennlp/tools/util/featuregen/TestDictionarySerializerMappingExtractionxml
@@ -0,0 +1,22 @@
+<!--
+	Licensed to the Apache Software Foundation (ASF) under one
+	or more contributor license agreements.  See the NOTICE file
+	distributed with this work for additional information
+	regarding copyright ownership.  The ASF licenses this file
+	to you under the Apache License, Version 2.0 (the
+	"License"); you may not use this file except in compliance
+	with the License.  You may obtain a copy of the License at
+	
+	http://www.apache.org/licenses/LICENSE-2.0
+	
+	Unless required by applicable law or agreed to in writing,
+	software distributed under the License is distributed on an
+	"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+	KIND, either express or implied.  See the License for the
+	specific language governing permissions and limitations
+	under the License.
+-->
+
+<generators>
+  <dictionary dict="test.dictionary"/>
+</generators>
\ No newline at end of file
