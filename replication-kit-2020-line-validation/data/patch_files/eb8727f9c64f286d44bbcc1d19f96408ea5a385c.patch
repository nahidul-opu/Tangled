From eb8727f9c64f286d44bbcc1d19f96408ea5a385c Mon Sep 17 00:00:00 2001
From: Gilles <erans@apache.org>
Date: Mon, 17 Aug 2015 13:27:40 +0200
Subject: [PATCH] MATH-1256

Boundary check.
---
 src/changes/changes.xml                                     | 3 +++
 .../commons/math3/geometry/euclidean/oned/Interval.java     | 6 ++++++
 .../commons/math3/geometry/euclidean/oned/IntervalTest.java | 6 ++++++
 3 files changed, 15 insertions(+)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 858e5b42e8..124bfce626 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -51,6 +51,9 @@ If the output is not quite correct, check for invisible trailing spaces!
   </properties>
   <body>
     <release version="3.6" date="XXXX-XX-XX" description="">
+      <action dev="erans" type="fix" issue="MATH-1256">
+        Boundary check to construct an "Interval" (package "o.a.c.m.geometry.euclidean.oned").
+      </action>
       <action dev="erans" type="fix" issue="MATH-1255">
         Wrong neighbourhood size in class "KohonenUpdateAction" (package "o.a.c.m.ml.neuralnet.sofm").
       </action>
diff --git a/src/main/java/org/apache/commons/math3/geometry/euclidean/oned/Interval.java b/src/main/java/org/apache/commons/math3/geometry/euclidean/oned/Interval.java
index 18ebac721d..ca15231853 100644
--- a/src/main/java/org/apache/commons/math3/geometry/euclidean/oned/Interval.java
+++ b/src/main/java/org/apache/commons/math3/geometry/euclidean/oned/Interval.java
@@ -17,6 +17,8 @@
 package org.apache.commons.math3.geometry.euclidean.oned;
 
 import org.apache.commons.math3.geometry.partitioning.Region.Location;
+import org.apache.commons.math3.exception.NumberIsTooSmallException;
+import org.apache.commons.math3.exception.util.LocalizedFormats;
 
 
 /** This class represents a 1D interval.
@@ -36,6 +38,10 @@ public class Interval {
      * @param upper upper bound of the interval
      */
     public Interval(final double lower, final double upper) {
+        if (upper < lower) {
+            throw new NumberIsTooSmallException(LocalizedFormats.ENDPOINTS_NOT_AN_INTERVAL,
+                                                upper, lower, true);
+        }
         this.lower = lower;
         this.upper = upper;
     }
diff --git a/src/test/java/org/apache/commons/math3/geometry/euclidean/oned/IntervalTest.java b/src/test/java/org/apache/commons/math3/geometry/euclidean/oned/IntervalTest.java
index dd3b461ca8..67a75b4685 100644
--- a/src/test/java/org/apache/commons/math3/geometry/euclidean/oned/IntervalTest.java
+++ b/src/test/java/org/apache/commons/math3/geometry/euclidean/oned/IntervalTest.java
@@ -19,6 +19,7 @@
 import org.apache.commons.math3.geometry.partitioning.Region;
 import org.apache.commons.math3.util.FastMath;
 import org.apache.commons.math3.util.Precision;
+import org.apache.commons.math3.exception.NumberIsTooSmallException;
 import org.junit.Assert;
 import org.junit.Test;
 
@@ -71,4 +72,9 @@ public void testSinglePoint() {
         Assert.assertEquals(1.0, interval.getBarycenter(), Precision.EPSILON);
     }
 
+    // MATH-1256
+    @Test(expected=NumberIsTooSmallException.class)
+    public void testStrictOrdering() {
+        new Interval(0, -1);
+    }
 }
