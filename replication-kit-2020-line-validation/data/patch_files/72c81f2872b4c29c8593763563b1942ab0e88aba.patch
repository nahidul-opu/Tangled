From 72c81f2872b4c29c8593763563b1942ab0e88aba Mon Sep 17 00:00:00 2001
From: Mark Thomas <markt@apache.org>
Date: Thu, 19 Feb 2009 22:21:50 +0000
Subject: [PATCH] Fix test failure caused by DBCP-215 fix.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/dbcp/trunk@746032 13f79535-47bb-0310-9956-ffa450edef68
---
 src/java/org/apache/commons/dbcp/BasicDataSourceFactory.java | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/java/org/apache/commons/dbcp/BasicDataSourceFactory.java b/src/java/org/apache/commons/dbcp/BasicDataSourceFactory.java
index cfe41243fa..331d8676f6 100644
--- a/src/java/org/apache/commons/dbcp/BasicDataSourceFactory.java
+++ b/src/java/org/apache/commons/dbcp/BasicDataSourceFactory.java
@@ -324,7 +324,9 @@ else if ("SERIALIZABLE".equalsIgnoreCase(value)) {
 
         // DBCP-215
         // Trick to make sure that initialSize connections are created
-        dataSource.getLogWriter();
+        if (dataSource.initialSize > 0) {
+            dataSource.getLogWriter();
+        }
 
         // Return the configured DataSource instance
         return dataSource;
