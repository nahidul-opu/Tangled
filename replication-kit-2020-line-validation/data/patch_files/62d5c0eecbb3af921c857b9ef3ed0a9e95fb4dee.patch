From 62d5c0eecbb3af921c857b9ef3ed0a9e95fb4dee Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Tue, 25 Sep 2012 01:07:01 +0000
Subject: [PATCH] LANG-826 FastDateParser does not handle non-ASCII digits
 correctly

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/lang/trunk@1389673 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                       | 1 +
 .../java/org/apache/commons/lang3/time/FastDateParser.java    | 4 ++--
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 393293a2b73..2cb636e3211 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -22,6 +22,7 @@
   <body>
 
   <release version="3.2" date="TBA" description="Next release">
+    <action issue="LANG-826" type="fix">FastDateParser does not handle non-ASCII digits correctly</action>
     <action issue="LANG-825" type="add">Create StrBuilder APIs similar to String.format(String, Object...)</action>
     <action issue="LANG-817" type="fix">Add org.apache.commons.lang3.SystemUtils.IS_OS_WINDOWS_8</action>
     <action issue="LANG-813" type="fix">StringUtils.equalsIgnoreCase doesn't check string reference equality</action>
diff --git a/src/main/java/org/apache/commons/lang3/time/FastDateParser.java b/src/main/java/org/apache/commons/lang3/time/FastDateParser.java
index 99e197ef1ea..e69ab40ccd7 100644
--- a/src/main/java/org/apache/commons/lang3/time/FastDateParser.java
+++ b/src/main/java/org/apache/commons/lang3/time/FastDateParser.java
@@ -684,10 +684,10 @@ public boolean isNumber() {
         @Override
         public boolean addRegex(FastDateParser parser, StringBuilder regex) {
             if(parser.isNextNumber()) {
-                regex.append("(\\d{").append(parser.getFieldWidth()).append("}+)");
+                regex.append("(\\p{IsNd}{").append(parser.getFieldWidth()).append("}+)");
             }
             else {
-                regex.append("(\\d++)");
+                regex.append("(\\p{IsNd}++)");
             }
             return true;
         }
