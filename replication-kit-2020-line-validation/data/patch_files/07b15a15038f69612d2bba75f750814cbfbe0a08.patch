From 07b15a15038f69612d2bba75f750814cbfbe0a08 Mon Sep 17 00:00:00 2001
From: Stefan Bodewig <bodewig@apache.org>
Date: Fri, 24 Jan 2014 14:41:14 +0000
Subject: [PATCH] COMPRESS-259 also honor decompressConcatenated when the
 format has been specified explicitly

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/compress/trunk@1561024 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                     | 4 ++++
 .../compress/compressors/CompressorStreamFactory.java       | 6 +++---
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 232710b3140..5c9ed08828a 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -53,6 +53,10 @@ The <action> type attribute can be add,update,fix,remove.
         archives used LZMA compression for headers and content and
         certain non-default dictinary sizes.
       </action>
+      <action issue="COMPRESS-259" type="fix" date="2014-01-24">
+        CompressorStreamFactory.createCompressorInputStream with
+        explicit compression did not honor decompressConcatenated
+      </action>
     </release>
     <release version="1.7" date="2014-01-20"
              description="Release 1.7">
diff --git a/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java b/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java
index 448944186db..482cbcd0f58 100644
--- a/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java
+++ b/src/main/java/org/apache/commons/compress/compressors/CompressorStreamFactory.java
@@ -206,15 +206,15 @@ public CompressorInputStream createCompressorInputStream(final String name,
         try {
 
             if (GZIP.equalsIgnoreCase(name)) {
-                return new GzipCompressorInputStream(in);
+                return new GzipCompressorInputStream(in, decompressConcatenated);
             }
 
             if (BZIP2.equalsIgnoreCase(name)) {
-                return new BZip2CompressorInputStream(in);
+                return new BZip2CompressorInputStream(in, decompressConcatenated);
             }
 
             if (XZ.equalsIgnoreCase(name)) {
-                return new XZCompressorInputStream(in);
+                return new XZCompressorInputStream(in, decompressConcatenated);
             }
 
             if (LZMA.equalsIgnoreCase(name)) {
