From 0e3a5bf9d1fd57895bf1ada985ecc800f5261838 Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Tue, 12 Apr 2011 23:39:11 +0000
Subject: [PATCH] NET-404 FTPSSocketFactory does not override createSocket();
 causes java.net.SocketException: Unconnected sockets not implemented

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/trunk@1091601 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                     | 3 +++
 .../java/org/apache/commons/net/ftp/FTPSSocketFactory.java  | 6 ++++++
 2 files changed, 9 insertions(+)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index cbe5ef3f0..28e57c65c 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -85,6 +85,9 @@ KeyManagerUtils can be used to provide client certificates.
 
   All users are recommended to upgrade.
 ">
+            <action issue="NET-404" dev="sebb" type="fix">
+            FTPSSocketFactory does not override createSocket(); causes java.net.SocketException: Unconnected sockets not implemented.
+            </action>
             <action issue="NET-399" dev="sebb" type="fix" due-to="Noah Levitt">
             ftp data connection does not use connectTimeout.
             </action>
diff --git a/src/main/java/org/apache/commons/net/ftp/FTPSSocketFactory.java b/src/main/java/org/apache/commons/net/ftp/FTPSSocketFactory.java
index 1a0992278..4dcbc135f 100644
--- a/src/main/java/org/apache/commons/net/ftp/FTPSSocketFactory.java
+++ b/src/main/java/org/apache/commons/net/ftp/FTPSSocketFactory.java
@@ -39,6 +39,12 @@ public FTPSSocketFactory(SSLContext context) {
         this.context = context;
     }
 
+    // Override the default implementation
+    @Override
+    public Socket createSocket() throws IOException{
+        return this.context.getSocketFactory().createSocket();
+    }
+
     @Override
     public Socket createSocket(String address, int port) throws UnknownHostException, IOException {
         return this.context.getSocketFactory().createSocket(address, port);
