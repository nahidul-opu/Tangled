From 7ee6b67c1983aa06e4585eb76fab0d7441fe0a3d Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Wed, 22 Feb 2012 23:42:49 +0000
Subject: [PATCH] COMPRESS-175 - GNU Tar sometimes uses binary encoding for UID
 and GID

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/compress/trunk@1292586 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                       | 3 +++
 .../commons/compress/archivers/tar/TarArchiveEntry.java       | 4 ++--
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 206d6441da9..f29ce0b7703 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -46,6 +46,9 @@ The <action> type attribute can be add,update,fix,remove.
   <body>
     <release version="1.4" date="unreleased"
              description="Release 1.4">
+      <action issue="COMPRESS-175" type="fix" date="2012-02-22">
+        GNU Tar sometimes uses binary encoding for UID and GID
+      </action> 
       <action issue="COMPRESS-171" type="fix" date="2012-01-29">
         ArchiveStreamFactory.createArchiveInputStream would claim
         short text files were TAR archives.
diff --git a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java
index 69a00ebb8d7..a5b037e20af 100644
--- a/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java
+++ b/src/main/java/org/apache/commons/compress/archivers/tar/TarArchiveEntry.java
@@ -803,9 +803,9 @@ public void parseTarHeader(byte[] header) {
         offset += NAMELEN;
         mode = (int) TarUtils.parseOctal(header, offset, MODELEN);
         offset += MODELEN;
-        userId = (int) TarUtils.parseOctal(header, offset, UIDLEN);
+        userId = (int) TarUtils.parseOctalOrBinary(header, offset, UIDLEN);
         offset += UIDLEN;
-        groupId = (int) TarUtils.parseOctal(header, offset, GIDLEN);
+        groupId = (int) TarUtils.parseOctalOrBinary(header, offset, GIDLEN);
         offset += GIDLEN;
         size = TarUtils.parseOctalOrBinary(header, offset, SIZELEN);
         offset += SIZELEN;
