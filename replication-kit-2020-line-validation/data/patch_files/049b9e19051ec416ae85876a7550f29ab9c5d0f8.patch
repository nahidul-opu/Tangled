From 049b9e19051ec416ae85876a7550f29ab9c5d0f8 Mon Sep 17 00:00:00 2001
From: Lewis John McGibbney <lewismc@apache.org>
Date: Mon, 12 Nov 2012 13:03:37 +0000
Subject: [PATCH] GORA-172 java.lang.ClassNotFoundException:
 org.apache.gora.memory.store.MemStore.MemQuery

git-svn-id: https://svn.apache.org/repos/asf/gora/trunk@1408272 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                                 | 2 ++
 .../main/java/org/apache/gora/memory/store/MemStore.java    | 1 -
 gora-core/src/main/java/org/apache/gora/util/IOUtils.java   | 6 +++---
 3 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index cea76d3b7..827f4b169 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -6,6 +6,8 @@ Gora Change Log
 
 trunk (current development)
 
+* GORA-172 java.lang.ClassNotFoundException: org.apache.gora.memory.store.MemStore.MemQuery (yumeng via lewismc)
+
 * GORA-103 Datastore for gora-dynamodb (rmarroquin via lewismc)
 
 * GORA-160 Gora Fails to Import Into Recent Versions of Eclipse (Ed Kohlwey via lewismc)
diff --git a/gora-core/src/main/java/org/apache/gora/memory/store/MemStore.java b/gora-core/src/main/java/org/apache/gora/memory/store/MemStore.java
index f35567b79..fd31436ee 100644
--- a/gora-core/src/main/java/org/apache/gora/memory/store/MemStore.java
+++ b/gora-core/src/main/java/org/apache/gora/memory/store/MemStore.java
@@ -26,7 +26,6 @@
 import java.util.NavigableMap;
 import java.util.TreeMap;
 
-import org.apache.gora.persistency.Persistent;
 import org.apache.gora.persistency.impl.PersistentBase;
 import org.apache.gora.persistency.impl.StateManagerImpl;
 import org.apache.gora.query.PartitionQuery;
diff --git a/gora-core/src/main/java/org/apache/gora/util/IOUtils.java b/gora-core/src/main/java/org/apache/gora/util/IOUtils.java
index 6745be6f6..ac55bb0d8 100644
--- a/gora-core/src/main/java/org/apache/gora/util/IOUtils.java
+++ b/gora-core/src/main/java/org/apache/gora/util/IOUtils.java
@@ -146,7 +146,7 @@ public static<T> void serialize(Configuration conf, DataOutput out
   @SuppressWarnings("unchecked")
   public static<T> void serialize(Configuration conf, DataOutput out
       , T obj) throws IOException {
-    Text.writeString(out, obj.getClass().getCanonicalName());
+    Text.writeString(out, obj.getClass().getName());
     serialize(conf, out, obj, (Class<T>)obj.getClass());
   }
 
@@ -460,7 +460,7 @@ public static String[] readStringArray(DataInput in) throws IOException {
   public static<T> void storeToConf(T obj, Configuration conf, String dataKey)
     throws IOException {
     String classKey = dataKey + "._class";
-    conf.set(classKey, obj.getClass().getCanonicalName());
+    conf.set(classKey, obj.getClass().getName());
     DefaultStringifier.store(conf, obj, dataKey);
   }
 
@@ -525,4 +525,4 @@ public static byte[] readFully(InputStream in) throws IOException {
     return getAsBytes(buffers);
   }
 
-}
\ No newline at end of file
+}
