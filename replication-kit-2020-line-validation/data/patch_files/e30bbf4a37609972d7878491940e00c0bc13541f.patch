From e30bbf4a37609972d7878491940e00c0bc13541f Mon Sep 17 00:00:00 2001
From: Xavier Hanin <xavier@apache.org>
Date: Wed, 17 Aug 2005 17:46:07 +0000
Subject: [PATCH] FIX: 'null' status attribute in module descriptor (IVY-62)

git-svn-id: https://svn.apache.org/repos/asf/incubator/ivy/trunk@484018 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                           | 1 +
 src/java/fr/jayasoft/ivy/DefaultModuleDescriptor.java | 7 +++++--
 2 files changed, 6 insertions(+), 2 deletions(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index 6f74de10e..728ffcfeb 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -14,6 +14,7 @@
 - new type filtering in cachepath task
 - new cachefileset task: builds an ant fileset of artifacts in cache
 - publish task now uses srcivypattern for ivy files finding and for delivery
+- FIX: 'null' status attribute in module descriptor (IVY-62)
 - FIX: report header contains incorrect link after resolve for multiple, comma-separated configurations (IVY-57)
 - FIX: error retrieving dependencies with a '+' in their revision if the ivy file doesn't exist - fixed by maarten coene (IVY-59)
 - FIX: trying to resolve latest with no revision in pattern caused a StackOverflowError (IVY-56)
diff --git a/src/java/fr/jayasoft/ivy/DefaultModuleDescriptor.java b/src/java/fr/jayasoft/ivy/DefaultModuleDescriptor.java
index 2dd229a43..707288160 100644
--- a/src/java/fr/jayasoft/ivy/DefaultModuleDescriptor.java
+++ b/src/java/fr/jayasoft/ivy/DefaultModuleDescriptor.java
@@ -41,7 +41,7 @@ public static DefaultModuleDescriptor newDefaultInstance(ModuleRevisionId mrid,
     
 	private ModuleRevisionId _revId;
 	private ModuleRevisionId _resolvedRevId;
-	private String _status;
+	private String _status = Status.DEFAULT_STATUS;
 	private Date _publicationDate;
 	private Date _resolvedPublicationDate;
 	private List _dependencies = new ArrayList();
@@ -60,7 +60,10 @@ public DefaultModuleDescriptor(ModuleRevisionId id, String status, Date pubDate)
     
     public DefaultModuleDescriptor(ModuleRevisionId id, String status, Date pubDate, boolean isDefault) {
         if (id == null) {
-            throw new NullPointerException("null module reivsion id not allowed");
+            throw new NullPointerException("null module revision id not allowed");
+        }
+        if (status == null) {
+            throw new NullPointerException("null status not allowed");
         }
         _revId = id;
         _resolvedRevId = id;
