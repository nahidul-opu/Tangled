From 316dfd409563f1396521798aefab04ce7999f84f Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Sat, 29 Nov 2014 01:27:52 +0000
Subject: [PATCH] NET-558 - getModificationTime(<filename>) returns complete
 received line including response code

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/trunk@1642389 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                 | 3 +++
 src/main/java/org/apache/commons/net/ftp/FTPClient.java | 4 ++--
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 58e81e2e0..6f9e219de 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -68,6 +68,9 @@ This is mainly a bug-fix release. See further details below.
   IMAPExportMbox (example app) allows IMAP folders to be exported into an mbox file.
   This is the inverse of the IMAPImportMbox example added previously
         ">
+            <action issue="NET-558" type="fix" dev="sebb" due-to="Ralph Becker">
+            FTPClient.getModificationTime(filename) returns complete received line including response code
+            </action>
             <action issue="NET-556" type="update" dev="sebb" due-to="Andy Rosa">
             Make SubnetInfo.isInRange(int) public
             </action>
diff --git a/src/main/java/org/apache/commons/net/ftp/FTPClient.java b/src/main/java/org/apache/commons/net/ftp/FTPClient.java
index 5cb5c6a95..e309738e7 100644
--- a/src/main/java/org/apache/commons/net/ftp/FTPClient.java
+++ b/src/main/java/org/apache/commons/net/ftp/FTPClient.java
@@ -3426,7 +3426,7 @@ public String getStatus(String pathname) throws IOException
 
 
     /**
-     * Issue the FTP MDTM command (not supported by all servers to retrieve the last
+     * Issue the FTP MDTM command (not supported by all servers) to retrieve the last
      * modification time of a file. The modification string should be in the
      * ISO 3077 form "YYYYMMDDhhmmss(.xxx)?". The timestamp represented should also be in
      * GMT, but not all FTP servers honour this.
@@ -3438,7 +3438,7 @@ public String getStatus(String pathname) throws IOException
      */
     public String getModificationTime(String pathname) throws IOException {
         if (FTPReply.isPositiveCompletion(mdtm(pathname))) {
-            return getReplyString();
+            return getReplyString().substring(4); // skip the return code (e.g. 213) and the space
         }
         return null;
     }
