From cd16dac76ba87780fa3195b73264fb050d079a9b Mon Sep 17 00:00:00 2001
From: Maja Kabiljo <majakabiljo@maja-mbp.thefacebook.com>
Date: Thu, 4 Apr 2013 16:51:52 -0700
Subject: [PATCH] GIRAPH-605: Worker crashes if its vertices have no edges when
 using edge input (majakabiljo)

---
 CHANGELOG                                                  | 2 ++
 .../src/main/java/org/apache/giraph/edge/EdgeStore.java    | 7 +++++++
 2 files changed, 9 insertions(+)

diff --git a/CHANGELOG b/CHANGELOG
index 35303fa2e..d619155c6 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,8 @@
 Giraph Change Log
 
 Release 0.2.0 - unreleased
+  GIRAPH-605: Worker crashes if its vertices have no edges when using edge input (majakabiljo)
+
   GIRAPH-603: AbstractVertexToHive doesn't need message type (majakabiljo)
 
   GIRAPH-589: Remove unnecessary generics from input formats (majakabiljo)
diff --git a/giraph-core/src/main/java/org/apache/giraph/edge/EdgeStore.java b/giraph-core/src/main/java/org/apache/giraph/edge/EdgeStore.java
index 31012118f..d6653d035 100644
--- a/giraph-core/src/main/java/org/apache/giraph/edge/EdgeStore.java
+++ b/giraph-core/src/main/java/org/apache/giraph/edge/EdgeStore.java
@@ -163,6 +163,13 @@ private VertexEdges<I, E> convertInputToComputeEdges(
    * Note: this method is not thread-safe.
    */
   public void moveEdgesToVertices() {
+    if (transientEdges.isEmpty()) {
+      if (LOG.isInfoEnabled()) {
+        LOG.info("moveEdgesToVertices: No edges to move");
+      }
+      return;
+    }
+
     if (LOG.isInfoEnabled()) {
       LOG.info("moveEdgesToVertices: Moving incoming edges to vertices.");
     }
