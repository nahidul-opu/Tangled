From 1c95a2a5d9e40d1b7d8b4626890ff1babc4f8862 Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Mon, 20 Mar 2017 21:19:54 +0000
Subject: [PATCH] NET-584 Error when using org.apache.commons.net.ftp.FTPClient
 setControlKeepAliveTimeout

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/trunk@1787849 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                 | 3 +++
 src/main/java/org/apache/commons/net/ftp/FTPClient.java | 4 ----
 2 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index b18709a3b..c53e3f690 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -71,6 +71,9 @@ This is mainly a bug-fix release. See further details below.
  However it is not source compatible with releases before 3.4, as some methods were added to the interface NtpV3Packet in 3.4
         
 ">
+            <action issue="NET-584" type="fix" dev="sebb" due-to="Kazantsev Andrey Sergeevich/Nick Manley">
+            Error when using org.apache.commons.net.ftp.FTPClient setControlKeepAliveTimeout
+            </action>
             <action issue="NET-626" type="update" dev="sebb" due-to="Makoto Sakaguchi">
             SubnetUtils#SubnetUtils - improved comment
             </action>
diff --git a/src/main/java/org/apache/commons/net/ftp/FTPClient.java b/src/main/java/org/apache/commons/net/ftp/FTPClient.java
index d5ae42481..6e1a153fa 100644
--- a/src/main/java/org/apache/commons/net/ftp/FTPClient.java
+++ b/src/main/java/org/apache/commons/net/ftp/FTPClient.java
@@ -3928,16 +3928,12 @@ public void bytesTransferred(long totalBytesTransferred,
 
         int[] cleanUp() throws IOException {
             int remain = notAcked;
-            if (notAcked > 0) { // TODO remove this before next release!
-                System.err.println("NET-584: notAcked=" + notAcked);
-            }
             try {
                 while(notAcked > 0) {
                     parent.getReply(); // we do want to see these
                     notAcked--; // only decrement if actually received
                 }
             } catch (SocketTimeoutException e) { // NET-584
-                System.err.println("NET-584: ignoring " + e.getMessage()); // TODO remove print before release!
                 // ignored
             } finally {
                 parent.setSoTimeout(currentSoTimeout);
