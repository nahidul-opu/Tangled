From 771f3bd0fcdde9bb5b7aa760adfead2d5da7a43c Mon Sep 17 00:00:00 2001
From: Maarten Coene <maartenc@apache.org>
Date: Thu, 1 Oct 2009 21:54:57 +0000
Subject: [PATCH] FIX: IvyBuildNumber non-deterministic behaviour (IVY-1120)

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@820818 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                     | 1 +
 src/java/org/apache/ivy/ant/IvyBuildNumber.java | 6 +++---
 2 files changed, 4 insertions(+), 3 deletions(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index d170b61b2..adfd5475d 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -94,6 +94,7 @@ for detailed view of each issue, please consult http://issues.apache.org/jira/br
 	
    trunk
 =====================================
+- FIX: IvyBuildNumber non-deterministic behaviour (IVY-1120)
 - FIX: Change spelling of 'occured' to 'occurred' (IVY-1123)
 - FIX: Ivy deliver fails to replace dynamic revision when using extra attributes (IVY-1111) (thanks to Michael Scheetz)
 - FIX: IbiblioResolver not always correctly configured when using JRE 1.5 (IVY-1124) (thanks to Flavio Coutinho da Costa)
diff --git a/src/java/org/apache/ivy/ant/IvyBuildNumber.java b/src/java/org/apache/ivy/ant/IvyBuildNumber.java
index f19eada07..ac1324d5e 100644
--- a/src/java/org/apache/ivy/ant/IvyBuildNumber.java
+++ b/src/java/org/apache/ivy/ant/IvyBuildNumber.java
@@ -165,9 +165,9 @@ public void doExecute() throws BuildException {
             private PatternMatcher regexp = new ExactOrRegexpPatternMatcher();
         
             public Matcher getMatcher(String expression) {
-                if ((expression == organisation)
-                        || (expression == module)
-                        || (expression == branch)) {
+                if (expression.equals(organisation)
+                        || expression.equals(module)
+                        || expression.equals(branch)) {
                     return exact.getMatcher(expression);
                 }
                 return regexp.getMatcher(expression);
