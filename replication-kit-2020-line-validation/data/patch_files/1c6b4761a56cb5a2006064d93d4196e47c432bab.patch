From 1c6b4761a56cb5a2006064d93d4196e47c432bab Mon Sep 17 00:00:00 2001
From: Rahul Akolkar <rahul@apache.org>
Date: Tue, 23 Dec 2008 06:27:54 +0000
Subject: [PATCH] ObjectCreationFactory#createObject() retuning null, NPE when
 log debug is enabled. DIGESTER-126

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/digester/trunk@728882 13f79535-47bb-0310-9956-ffa450edef68
---
 RELEASE-NOTES.txt                                           | 3 +++
 src/java/org/apache/commons/digester/FactoryCreateRule.java | 6 ++++--
 2 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/RELEASE-NOTES.txt b/RELEASE-NOTES.txt
index fe3f1ff19..7e109c589 100644
--- a/RELEASE-NOTES.txt
+++ b/RELEASE-NOTES.txt
@@ -56,6 +56,9 @@ IMPROVEMENTS FROM PREVIOUS RELEASE
  * [DIGESTER-122] Potential NullPointerException if debug is enabled in
                   Digester#resolveEntity()
 
+ * [DIGESTER-126] Potential NullPointerException if debug is enabled in
+                  FactoryCreateRule#begin()
+
 DEPRECATIONS
 ============
 None
diff --git a/src/java/org/apache/commons/digester/FactoryCreateRule.java b/src/java/org/apache/commons/digester/FactoryCreateRule.java
index 3c19e2e50..bd20a75ae 100644
--- a/src/java/org/apache/commons/digester/FactoryCreateRule.java
+++ b/src/java/org/apache/commons/digester/FactoryCreateRule.java
@@ -369,7 +369,8 @@ public void begin(String namespace, String name, Attributes attributes) throws E
                 
                 if (digester.log.isDebugEnabled()) {
                     digester.log.debug("[FactoryCreateRule]{" + digester.match +
-                            "} New " + instance.getClass().getName());
+                            "} New " + (instance == null ? "null object" :
+                            instance.getClass().getName()));
                 }
                 digester.push(instance);
                 exceptionIgnoredStack.push(Boolean.FALSE);
@@ -391,7 +392,8 @@ public void begin(String namespace, String name, Attributes attributes) throws E
             
             if (digester.log.isDebugEnabled()) {
                 digester.log.debug("[FactoryCreateRule]{" + digester.match +
-                        "} New " + instance.getClass().getName());
+                        "} New " + (instance == null ? "null object" :
+                        instance.getClass().getName()));
             }
             digester.push(instance);
         }
