From b5ac3314309acc4cded8f65cf50adeb7a1c13f95 Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Tue, 10 Jan 2012 19:19:35 +0000
Subject: [PATCH] NET-412 Apache Commons TFTP implementation subject to
 Sorcerer's Apprentice Syndrome

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/trunk@1229695 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                   | 3 +++
 src/main/java/org/apache/commons/net/tftp/TFTPClient.java | 3 ---
 2 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 29fa71267..a4d2bbcb5 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -59,6 +59,9 @@ The <action> type attribute can be add,update,fix,remove.
         <release version="3.1-SNAPSHOT" date="TBA" description="
 TBA
         ">
+            <action issue="NET-412" dev="sebb" type="fix" due-to="Chuck Wolber">
+            Apache Commons TFTP implementation subject to Sorcerer's Apprentice Syndrome
+            </action>
             <action issue="NET-410" dev="sebb" type="fix" due-to="Chuck Wolber">
             Apache Commons TFTP does not handle RFC 783 retransmits
             </action>
diff --git a/src/main/java/org/apache/commons/net/tftp/TFTPClient.java b/src/main/java/org/apache/commons/net/tftp/TFTPClient.java
index f82ce857f..886f4bc35 100644
--- a/src/main/java/org/apache/commons/net/tftp/TFTPClient.java
+++ b/src/main/java/org/apache/commons/net/tftp/TFTPClient.java
@@ -487,9 +487,6 @@ public void sendFile(String filename, int mode, InputStream input,
                         {
                             discardPackets();
 
-                            if (lastBlock == (block == 0 ? 65535 : (block - 1)))
-                                continue _sendPacket;  // Resend last acknowledgement.
-
                             continue _receivePacket; // Start fetching packets again.
                         }
                         //break;
