From fffe2ee6cd3b67aabb36f656f47f09591bc355e2 Mon Sep 17 00:00:00 2001
From: Maarten Coene <maartenc@apache.org>
Date: Tue, 21 Oct 2008 19:26:15 +0000
Subject: [PATCH] FIX: Maven pom license has name as optional element (IVY-949)

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@706728 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                         |  1 +
 .../org/apache/ivy/plugins/parser/m2/PomReader.java | 13 +++++++++++--
 2 files changed, 12 insertions(+), 2 deletions(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index 6ed56a1e9..022ba46fd 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -111,6 +111,7 @@ for detailed view of each issue, please consult http://issues.apache.org/jira/br
 - FIX: Support for passing arbitrary arguments to the -main invoked class when using the standalone mode is severely limited (IVY-952) (thanks to Patrick Woodworth)
 - FIX: Correctly set ivy.resolved.configurations property when the conf string includes a negation operator (IVY-951) (thanks to Patrick Woodworth)
 - FIX: Maven pom license url can contain xml entities (IVY-950)
+- FIX: Maven pom license has name as optional element (IVY-949)
 
    2.0.0-rc1
 =====================================
diff --git a/src/java/org/apache/ivy/plugins/parser/m2/PomReader.java b/src/java/org/apache/ivy/plugins/parser/m2/PomReader.java
index 525a31ef2..ed556d8ee 100644
--- a/src/java/org/apache/ivy/plugins/parser/m2/PomReader.java
+++ b/src/java/org/apache/ivy/plugins/parser/m2/PomReader.java
@@ -222,9 +222,18 @@ public License[] getLicenses() {
             if (LICENSE.equals(license.getNodeName())) {
                 String name = getFirstChildText(license, LICENSE_NAME);
                 String url = getFirstChildText(license, LICENSE_URL);
-                if (name != null || url != null) {
-                    lics.add(new License(name, url));
+                
+                if ((name == null) && (url == null)) {
+                    // move to next license
+                    continue;
                 }
+                
+                if (name == null) {
+                    // The license name is required in Ivy but not in a POM!
+                    name = "Unknown License";
+                }
+                
+                lics.add(new License(name, url));
             }
         }
         return (License[]) lics.toArray(new License[lics.size()]);
