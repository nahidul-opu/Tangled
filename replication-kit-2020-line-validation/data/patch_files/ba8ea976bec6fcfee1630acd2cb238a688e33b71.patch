From ba8ea976bec6fcfee1630acd2cb238a688e33b71 Mon Sep 17 00:00:00 2001
From: Claudio Martella <claudio@apache.org>
Date: Fri, 22 Nov 2013 11:56:40 +0100
Subject: [PATCH] GIRAPH-797

---
 CHANGELOG                                            |  5 ++++-
 .../org/apache/giraph/utils/ConfigurationUtils.java  | 12 ++++++++++++
 2 files changed, 16 insertions(+), 1 deletion(-)

diff --git a/CHANGELOG b/CHANGELOG
index 5c9a73304..db7f29566 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,8 +1,11 @@
 Giraph Change Log
 
 Release 1.1.0 - unreleased
+  GIRAPH-797: If the vertex input data path is incorrect Giraph job hangs indefinitely 
+  until killed by JobTracker for exceeding timeout (jaeyu via claudio)
+
   GIRAPH-793: Create necessary documentation for Giraph-Gora integration 
-  (enato2099 via claudio)
+  (renato2099 via claudio)
 
   GIRAPH-760: Create EdgeOutputFormat to Apache Gora (renato2099 via claudio)
 
diff --git a/giraph-core/src/main/java/org/apache/giraph/utils/ConfigurationUtils.java b/giraph-core/src/main/java/org/apache/giraph/utils/ConfigurationUtils.java
index e441f0377..da4b98e8b 100644
--- a/giraph-core/src/main/java/org/apache/giraph/utils/ConfigurationUtils.java
+++ b/giraph-core/src/main/java/org/apache/giraph/utils/ConfigurationUtils.java
@@ -401,6 +401,12 @@ private static void populateGiraphConfiguration(final GiraphConfiguration
     // Now, we parse options that are specific to Hadoop MR Job
     if (cmd.hasOption("vif")) {
       if (cmd.hasOption("vip")) {
+        if (FileSystem.get(new Configuration()).listStatus(
+              new Path(cmd.getOptionValue("vip"))) == null) {
+          throw new IllegalArgumentException(
+              "Invalid vertex input path (-vip): " +
+              cmd.getOptionValue("vip"));
+        }
         GiraphFileInputFormat.addVertexInputPath(conf,
           new Path(cmd.getOptionValue("vip")));
       } else {
@@ -412,6 +418,12 @@ private static void populateGiraphConfiguration(final GiraphConfiguration
     }
     if (cmd.hasOption("eif")) {
       if (cmd.hasOption("eip")) {
+        if (FileSystem.get(new Configuration()).listStatus(
+              new Path(cmd.getOptionValue("eip"))) == null) {
+          throw new IllegalArgumentException(
+              "Invalid edge input path (-eip): " +
+              cmd.getOptionValue("eip"));
+        }
         GiraphFileInputFormat.addEdgeInputPath(conf,
           new Path(cmd.getOptionValue("eip")));
       } else {
