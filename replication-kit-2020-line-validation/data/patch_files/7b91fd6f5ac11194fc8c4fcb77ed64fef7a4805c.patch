From 7b91fd6f5ac11194fc8c4fcb77ed64fef7a4805c Mon Sep 17 00:00:00 2001
From: Avery Ching <aching@apache.org>
Date: Fri, 7 Sep 2012 21:35:59 +0000
Subject: [PATCH] GIRAPH-321: Divide by 0 exception. (ereisman via aching)

git-svn-id: https://svn.apache.org/repos/asf/giraph/trunk@1382184 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGELOG                                                   | 3 +++
 .../java/org/apache/giraph/graph/LocalityInfoSorter.java    | 6 ++++--
 2 files changed, 7 insertions(+), 2 deletions(-)

diff --git a/CHANGELOG b/CHANGELOG
index 50048d90e..0c86cf0f1 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,9 @@
 Giraph Change Log
 
 Release 0.2.0 - unreleased
+
+  GIRAPH-321: Divide by 0 exception. (ereisman via aching)
+
   GIRAPH-316: Add test-patch.sh for precommit test using Jenkins.
   (hyunsik via ereisman)
 
diff --git a/src/main/java/org/apache/giraph/graph/LocalityInfoSorter.java b/src/main/java/org/apache/giraph/graph/LocalityInfoSorter.java
index 8204a77b4..01bd321e1 100644
--- a/src/main/java/org/apache/giraph/graph/LocalityInfoSorter.java
+++ b/src/main/java/org/apache/giraph/graph/LocalityInfoSorter.java
@@ -104,8 +104,10 @@ private void prioritizeLocalInputSplits(final int port) {
     // determine the hash-based offset for this worker to iterate from
     // and place the local blocks into the list at that index, if any
     final int temp = hostName.hashCode() + (19 * port);
-    baseOffset =
-      Math.abs(temp == Integer.MIN_VALUE ? 0 : temp) % pathList.size();
+    if (pathList.size() != 0) {
+      baseOffset =
+        Math.abs(temp == Integer.MIN_VALUE ? 0 : temp) % pathList.size();
+    }
     // re-insert local paths at "adjusted index zero" for caller to iterate on
     pathList.addAll(baseOffset, sortedList);
   }
