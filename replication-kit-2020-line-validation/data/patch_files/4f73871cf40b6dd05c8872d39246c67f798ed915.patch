From 4f73871cf40b6dd05c8872d39246c67f798ed915 Mon Sep 17 00:00:00 2001
From: Gilles <erans@apache.org>
Date: Thu, 13 Aug 2015 23:32:37 +0200
Subject: [PATCH] MATH-1255

Wrong usage of "Gaussian" function.
---
 src/changes/changes.xml                                        | 3 +++
 .../commons/math4/ml/neuralnet/sofm/KohonenUpdateAction.java   | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 18496889c3..f1076db0df 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -54,6 +54,9 @@ If the output is not quite correct, check for invisible trailing spaces!
     </release>
 
     <release version="4.0" date="XXXX-XX-XX" description="">
+      <action dev="erans" type="fix" issue="MATH-1255">
+        Wrong neighbourhood size in class "KohonenUpdateAction" (package "o.a.c.m.ml.neuralnet.sofm").
+      </action>
       <action dev="psteitz" type="fix" issue="MATH-1252" due-to="John Bay"> <!-- backported to 3.6 -->
         ResizableDoubleArray constructor does not work with double array of size 1.
       </action>
diff --git a/src/main/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateAction.java b/src/main/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateAction.java
index 1b4b54eac1..87e1bbca21 100644
--- a/src/main/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateAction.java
+++ b/src/main/java/org/apache/commons/math4/ml/neuralnet/sofm/KohonenUpdateAction.java
@@ -107,7 +107,7 @@ public void update(Network net,
         final Gaussian neighbourhoodDecay
             = new Gaussian(currentLearning,
                            0,
-                           1d / currentNeighbourhood);
+                           currentNeighbourhood);
 
         if (currentNeighbourhood > 0) {
             // Initial set of neurons only contains the winning neuron.
