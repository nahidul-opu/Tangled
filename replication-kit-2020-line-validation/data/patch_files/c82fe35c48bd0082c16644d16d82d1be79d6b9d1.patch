From c82fe35c48bd0082c16644d16d82d1be79d6b9d1 Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Thu, 4 Jun 2015 14:01:15 +0000
Subject: [PATCH] CODEC-200 - Base32.HEX_DECODE_TABLE contains the wrong value
 32

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/codec/trunk@1683550 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                   | 5 +++--
 src/main/java/org/apache/commons/codec/binary/Base32.java | 8 ++++----
 .../java/org/apache/commons/codec/binary/Base32Test.java  | 8 ++++++++
 3 files changed, 15 insertions(+), 6 deletions(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 74636b07ac..6c40ceace5 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -1,4 +1,4 @@
-﻿<?xml version="1.0"?>
+﻿﻿<?xml version="1.0"?>
 <!--
    Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
@@ -39,10 +39,11 @@ The <action> type attribute can be add,update,fix,remove.
 <document>
   <properties>
     <title>Changes</title>
-    <author>Gary Gregory</author>
+    <author>Apache Commons Developers</author>
   </properties>
   <body>
     <release version="1.11" date="DD MM 2015" description="Feature and fix release.">        
+      <action issue="CODEC-200" dev="sebb" type="fix" due-to="Luciano Vernaschi">Base32.HEX_DECODE_TABLE contains the wrong value 32</action>   
       <action dev="ggregory" type="add" issue="CODEC-199" due-to="Yossi Tamari">Bug in HW rule in Soundex</action>         
       <action dev="ggregory" type="add" issue="CODEC-183" due-to="Steven Wurster">BaseNCodecOutputStream only supports writing EOF on close()</action>         
       <action dev="ggregory" type="add" issue="CODEC-195" due-to="Gary Gregory">Support SHA-224 in DigestUtils on Java 8</action>         
diff --git a/src/main/java/org/apache/commons/codec/binary/Base32.java b/src/main/java/org/apache/commons/codec/binary/Base32.java
index 1913e40a7d..e40d652561 100644
--- a/src/main/java/org/apache/commons/codec/binary/Base32.java
+++ b/src/main/java/org/apache/commons/codec/binary/Base32.java
@@ -70,8 +70,8 @@ public class Base32 extends BaseNCodec {
             -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, // 10-1f
             -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, // 20-2f
             -1, -1, 26, 27, 28, 29, 30, 31, -1, -1, -1, -1, -1, -1, -1, -1, // 30-3f 2-7
-            -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, // 40-4f A-N
-            15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,                     // 50-5a O-Z
+            -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, // 40-4f A-O
+            15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25,                     // 50-5a P-Z
     };
 
     /**
@@ -95,8 +95,8 @@ public class Base32 extends BaseNCodec {
             -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, // 10-1f
             -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, // 20-2f
              0,  1,  2,  3,  4,  5,  6,  7,  8,  9, -1, -1, -1, -1, -1, -1, // 30-3f 2-7
-            -1, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, // 40-4f A-N
-            25, 26, 27, 28, 29, 30, 31, 32,                                 // 50-57 O-V
+            -1, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, // 40-4f A-O
+            25, 26, 27, 28, 29, 30, 31,                                     // 50-57 P-V
     };
 
     /**
diff --git a/src/test/java/org/apache/commons/codec/binary/Base32Test.java b/src/test/java/org/apache/commons/codec/binary/Base32Test.java
index fbe4e79913..bfc3cdd7e1 100644
--- a/src/test/java/org/apache/commons/codec/binary/Base32Test.java
+++ b/src/test/java/org/apache/commons/codec/binary/Base32Test.java
@@ -19,6 +19,7 @@
 package org.apache.commons.codec.binary;
 
 import static org.junit.Assert.assertEquals;
+import static org.junit.Assert.assertNotNull;
 import static org.junit.Assert.fail;
 
 import java.util.Arrays;
@@ -151,4 +152,11 @@ public void testBase32SamplesNonDefaultPadding() throws Exception {
                 assertEquals(element[1], codec.encodeAsString(element[0].getBytes(Charsets.UTF_8)));
         }
     }
+
+    @Test
+    public void testCodec200() {
+        final Base32 codec = new Base32(true, (byte)'W'); // should be allowed
+        assertNotNull(codec);
+    }
+
 }
