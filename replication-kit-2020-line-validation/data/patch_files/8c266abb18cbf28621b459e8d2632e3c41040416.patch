From 8c266abb18cbf28621b459e8d2632e3c41040416 Mon Sep 17 00:00:00 2001
From: William Colen <colen@apache.org>
Date: Wed, 17 Aug 2011 11:36:22 +0000
Subject: [PATCH] OPENNLP-248 equals does not check span type correctly if one
 has null type

git-svn-id: https://svn.apache.org/repos/asf/incubator/opennlp/trunk@1158640 13f79535-47bb-0310-9956-ffa450edef68
---
 opennlp-tools/src/main/java/opennlp/tools/util/Span.java   | 3 ++-
 .../src/test/java/opennlp/tools/util/SpanTest.java         | 7 +++++++
 2 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/opennlp-tools/src/main/java/opennlp/tools/util/Span.java b/opennlp-tools/src/main/java/opennlp/tools/util/Span.java
index aeed09afe..23ed28bd0 100644
--- a/opennlp-tools/src/main/java/opennlp/tools/util/Span.java
+++ b/opennlp-tools/src/main/java/opennlp/tools/util/Span.java
@@ -227,7 +227,8 @@ else if (o instanceof Span) {
 
       result = (getStart() == s.getStart()) && 
           (getEnd() == s.getEnd()) &&
-          (getType() != null ? type.equals(s.getType()) : true);
+          (getType() != null ? type.equals(s.getType()) : true) &&
+          (s.getType() != null ? s.getType().equals(getType()) : true);
     }
     else {
       result = false;
diff --git a/opennlp-tools/src/test/java/opennlp/tools/util/SpanTest.java b/opennlp-tools/src/test/java/opennlp/tools/util/SpanTest.java
index c74a6df73..920499fb7 100644
--- a/opennlp-tools/src/test/java/opennlp/tools/util/SpanTest.java
+++ b/opennlp-tools/src/test/java/opennlp/tools/util/SpanTest.java
@@ -225,12 +225,19 @@ public void testEquals() {
 
     assertTrue(a1.equals(a2));
     
+    // end is different
     Span b1 = new Span(100, 100, "test");
     assertFalse(a1.equals(b1));
     
+    // type is different
     Span c1 = new Span(100, 1000, "Test");
     assertFalse(a1.equals(c1));
     
+    Span d1 = new Span(100, 1000);
+    
+    assertFalse(d1.equals(a1));
+    assertFalse(a1.equals(d1));
+    
   }
 
   /**
