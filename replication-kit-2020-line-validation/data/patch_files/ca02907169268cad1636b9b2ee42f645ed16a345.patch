From ca02907169268cad1636b9b2ee42f645ed16a345 Mon Sep 17 00:00:00 2001
From: Thomas Vandahl <tv@apache.org>
Date: Sun, 25 Aug 2013 10:15:50 +0000
Subject: [PATCH] Fix for JCS-106: Bad comparison of int with
 0x7fffffffffffffffL

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/jcs/trunk@1517262 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                        | 3 +++
 .../apache/jcs/auxiliary/remote/server/RemoteCacheServer.java  | 2 +-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index aa12e7c84..8a3531fbe 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -20,6 +20,9 @@
 	</properties>
 	<body>
 		<release version="2.0" date="unreleased" description="JDK 1.5 based major release">
+            <action dev="tv" type="fix" issue="JCS-106" due-to="Johannes Weberhofer">
+                Bad comparison of int with Long.MAX_VALUE.
+            </action>
             <action dev="tv" type="fix" issue="JCS-103" due-to="Pavel Novak">
                 MaxMemoryIdleTimeSeconds default value is wrongly documented.
             </action>
diff --git a/src/java/org/apache/jcs/auxiliary/remote/server/RemoteCacheServer.java b/src/java/org/apache/jcs/auxiliary/remote/server/RemoteCacheServer.java
index 39a8fa959..77a7e684c 100644
--- a/src/java/org/apache/jcs/auxiliary/remote/server/RemoteCacheServer.java
+++ b/src/java/org/apache/jcs/auxiliary/remote/server/RemoteCacheServer.java
@@ -1603,7 +1603,7 @@ public void unreferenced()
     private long nextListenerId()
     {
         long id = 0;
-        if ( listenerId[0] == Long.MAX_VALUE )
+        if ( listenerId[0] == Integer.MAX_VALUE )
         {
             synchronized ( listenerId )
             {
