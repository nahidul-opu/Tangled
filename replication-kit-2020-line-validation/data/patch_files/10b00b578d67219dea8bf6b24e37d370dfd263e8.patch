From 10b00b578d67219dea8bf6b24e37d370dfd263e8 Mon Sep 17 00:00:00 2001
From: Xavier Hanin <xavier@apache.org>
Date: Fri, 23 Feb 2007 09:50:53 +0000
Subject: [PATCH] check nullity to fail earlier, to help isolate IVY-355

git-svn-id: https://svn.apache.org/repos/asf/incubator/ivy/core/trunk@510889 13f79535-47bb-0310-9956-ffa450edef68
---
 src/java/org/apache/ivy/core/resolve/IvyNode.java        | 6 ++++++
 .../org/apache/ivy/core/resolve/IvyNodeEviction.java     | 6 ++++++
 src/java/org/apache/ivy/core/resolve/ResolveEngine.java  | 4 ++++
 src/java/org/apache/ivy/core/resolve/VisitNode.java      | 9 +++++++++
 4 files changed, 25 insertions(+)

diff --git a/src/java/org/apache/ivy/core/resolve/IvyNode.java b/src/java/org/apache/ivy/core/resolve/IvyNode.java
index bbb85d64a..76dbd0178 100644
--- a/src/java/org/apache/ivy/core/resolve/IvyNode.java
+++ b/src/java/org/apache/ivy/core/resolve/IvyNode.java
@@ -64,6 +64,12 @@ private static final class NodeConf {
         private String _conf;
 
         public NodeConf(IvyNode node, String conf) {
+        	if (node == null) {
+        		throw new NullPointerException("node must not null");
+        	}
+        	if (conf == null) {
+        		throw new NullPointerException("conf must not null");
+        	}
             _node = node;
             _conf = conf;
         }
diff --git a/src/java/org/apache/ivy/core/resolve/IvyNodeEviction.java b/src/java/org/apache/ivy/core/resolve/IvyNodeEviction.java
index 5f336d71e..5994abf4e 100644
--- a/src/java/org/apache/ivy/core/resolve/IvyNodeEviction.java
+++ b/src/java/org/apache/ivy/core/resolve/IvyNodeEviction.java
@@ -79,6 +79,12 @@ private static final class ModuleIdConf {
         private String _conf;
 
         public ModuleIdConf(ModuleId mid, String conf) {
+        	if (mid == null) {
+        		throw new NullPointerException("mid cannot be null");
+        	}
+        	if (conf == null) {
+        		throw new NullPointerException("conf cannot be null");
+        	}
             _moduleId = mid;
             _conf = conf;
         }
diff --git a/src/java/org/apache/ivy/core/resolve/ResolveEngine.java b/src/java/org/apache/ivy/core/resolve/ResolveEngine.java
index b0566f0ab..d64e62860 100644
--- a/src/java/org/apache/ivy/core/resolve/ResolveEngine.java
+++ b/src/java/org/apache/ivy/core/resolve/ResolveEngine.java
@@ -352,6 +352,10 @@ public IvyNode[] getDependencies(ModuleDescriptor md, ResolveOptions options, Re
         IvyNode rootNode = new IvyNode(data, md);
         
         for (int i = 0; i < confs.length; i++) {
+        	if (confs[i] == null) {
+        		throw new NullPointerException("null conf not allowed: confs where: "+Arrays.asList(confs));
+        	}
+        	
             // for each configuration we clear the cache of what's been fetched
             _fetchedSet.clear();     
             
diff --git a/src/java/org/apache/ivy/core/resolve/VisitNode.java b/src/java/org/apache/ivy/core/resolve/VisitNode.java
index 876ace660..5fb2ad0f9 100644
--- a/src/java/org/apache/ivy/core/resolve/VisitNode.java
+++ b/src/java/org/apache/ivy/core/resolve/VisitNode.java
@@ -100,6 +100,15 @@ public class VisitNode {
 
     
     public VisitNode(ResolveData data, IvyNode node, VisitNode parent, String rootModuleConf, String parentConf) {
+    	if (data == null) {
+    		throw new NullPointerException("data must not be null");
+    	}
+    	if (node == null) {
+    		throw new NullPointerException("node must not be null");
+    	}
+    	if (rootModuleConf == null) {
+    		throw new NullPointerException("rootModuleConf must not be null");
+    	}
     	_data = data;
     	_node = node;
     	_parent = parent;
