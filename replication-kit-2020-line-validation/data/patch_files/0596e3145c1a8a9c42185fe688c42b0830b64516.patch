From 0596e3145c1a8a9c42185fe688c42b0830b64516 Mon Sep 17 00:00:00 2001
From: Phil Steitz <psteitz@apache.org>
Date: Sat, 31 Oct 2009 02:30:18 +0000
Subject: [PATCH] Fixed parameter test in RandomDataImpl#nextExponential. JIRA:
 MATH-309.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/math/trunk@831510 13f79535-47bb-0310-9956-ffa450edef68
---
 .../org/apache/commons/math/random/RandomDataImpl.java     | 5 ++---
 src/site/xdoc/changes.xml                                  | 4 ++++
 .../org/apache/commons/math/random/RandomDataTest.java     | 7 ++++++-
 3 files changed, 12 insertions(+), 4 deletions(-)

diff --git a/src/main/java/org/apache/commons/math/random/RandomDataImpl.java b/src/main/java/org/apache/commons/math/random/RandomDataImpl.java
index d5d2474f7a..a44720fbe0 100644
--- a/src/main/java/org/apache/commons/math/random/RandomDataImpl.java
+++ b/src/main/java/org/apache/commons/math/random/RandomDataImpl.java
@@ -457,12 +457,11 @@ public double nextGaussian(double mu, double sigma) {
      * uniform deviates.
      * </p>
      *
-     * @param mean
-     *            the mean of the distribution
+     * @param mean the mean of the distribution
      * @return the random Exponential value
      */
     public double nextExponential(double mean) {
-        if (mean < 0.0) {
+        if (mean <= 0.0) {
             throw MathRuntimeException.createIllegalArgumentException(
                   "mean must be positive ({0})", mean);
         }
diff --git a/src/site/xdoc/changes.xml b/src/site/xdoc/changes.xml
index 9b41c13f32..82b4e024b9 100644
--- a/src/site/xdoc/changes.xml
+++ b/src/site/xdoc/changes.xml
@@ -39,6 +39,10 @@ The <action> type attribute can be add,update,fix,remove.
   </properties>
   <body>
     <release version="2.1" date="TBD" description="TBD">
+      <action dev="psteitz" type="fix" issue="MATH-309" due-to="Mikkel Meyer Andersen">
+        Fixed parameter test in RandomDataImpl#nextExponential. The method now throws
+        IllegalArgumentException for mean = 0.
+      </action>
       <action dev="brentworden" type="update" issue="MATH-311" due-to="Nipun Jawalkar">
         Changed probability calculations for Binomial, Poisson, and Hypergeometric
         distributions to use Catherine Loader's saddle point approximations.
diff --git a/src/test/java/org/apache/commons/math/random/RandomDataTest.java b/src/test/java/org/apache/commons/math/random/RandomDataTest.java
index cb6d07857d..46d34a2d7e 100644
--- a/src/test/java/org/apache/commons/math/random/RandomDataTest.java
+++ b/src/test/java/org/apache/commons/math/random/RandomDataTest.java
@@ -563,7 +563,12 @@ public void testNextExponential() {
 		} catch (IllegalArgumentException ex) {
 			// ignored
 		}
-		assertEquals("0 mean", 0, randomData.nextExponential(0), 10E-8);
+        try {
+            randomData.nextExponential(0);
+            fail("zero mean -- expecting IllegalArgumentException");
+        } catch (IllegalArgumentException ex) {
+            // ignored
+        }
 		long cumFreq = 0;
 		double v = 0;
 		for (int i = 0; i < largeSampleSize; i++) {
