From 3d5e169b975731cb028a7974d81e7be0f2f60282 Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Thu, 6 Jun 2013 11:32:38 +0000
Subject: [PATCH] NET-501 Race Condition on TelnetClient.disconnect() and
 TelnetInputStream.run()

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/trunk@1490241 13f79535-47bb-0310-9956-ffa450edef68
---
 src/changes/changes.xml                                       | 4 ++++
 .../java/org/apache/commons/net/telnet/TelnetInputStream.java | 1 -
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 317809d5a..744d66384 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -65,6 +65,10 @@ The <action> type attribute can be add,update,fix,remove.
         <release version="3.3" date="2013-06-??" description="
 This is a bug-fix release. See further details below.
         ">
+            <action issue="NET-501" dev="sebb" due-to="JuliÃ¡n Lastiri" type="fix">
+            Race Condition on TelnetClient.disconnect() and TelnetInputStream.run()
+            java.lang.IllegalStateException: Queue is full! Cannot process another character. 
+            </action>
             <action issue="NET-505" dev="sebb" due-to="Sean Kelley" type="update">
             User specified bufferSize reset to default when FTPClient is disconnected or reinitialized resulting in performance degradation.
             </action>
diff --git a/src/main/java/org/apache/commons/net/telnet/TelnetInputStream.java b/src/main/java/org/apache/commons/net/telnet/TelnetInputStream.java
index eb6539352..48900bcb5 100644
--- a/src/main/java/org/apache/commons/net/telnet/TelnetInputStream.java
+++ b/src/main/java/org/apache/commons/net/telnet/TelnetInputStream.java
@@ -594,7 +594,6 @@ public void close() throws IOException
             __queue.notifyAll();
         }
 
-        __threaded = false;
     }
 
 //    @Override
