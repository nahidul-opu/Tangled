From 959cb4977a82c3e597282c03a85fc7d9cce69844 Mon Sep 17 00:00:00 2001
From: Maarten Coene <maartenc@apache.org>
Date: Mon, 20 Oct 2008 22:54:23 +0000
Subject: [PATCH] FIX: Maven pom license url can contain xml entities (IVY-950)

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@706442 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                               | 1 +
 .../ivy/plugins/parser/xml/XmlModuleDescriptorWriter.java | 8 ++++----
 2 files changed, 5 insertions(+), 4 deletions(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index 330c781ec..6ed56a1e9 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -110,6 +110,7 @@ for detailed view of each issue, please consult http://issues.apache.org/jira/br
 - FIX: Extra Attributes specified in the Dependency's Module Descriptor are not available to resolvers (IVY-929) (thanks to Scott Hebert)
 - FIX: Support for passing arbitrary arguments to the -main invoked class when using the standalone mode is severely limited (IVY-952) (thanks to Patrick Woodworth)
 - FIX: Correctly set ivy.resolved.configurations property when the conf string includes a negation operator (IVY-951) (thanks to Patrick Woodworth)
+- FIX: Maven pom license url can contain xml entities (IVY-950)
 
    2.0.0-rc1
 =====================================
diff --git a/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorWriter.java b/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorWriter.java
index 5a7e2f8bb..ee9237858 100644
--- a/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorWriter.java
+++ b/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorWriter.java
@@ -447,21 +447,21 @@ private static void printInfoTag(ModuleDescriptor md, PrintWriter out) {
                 License license = licenses[i];
                 out.print("\t\t<license ");
                 if (license.getName() != null) {
-                    out.print("name=\"" + license.getName() + "\" ");
+                    out.print("name=\"" + XMLHelper.escape(license.getName()) + "\" ");
                 }
                 if (license.getUrl() != null) {
-                    out.print("url=\"" + license.getUrl() + "\" ");
+                    out.print("url=\"" + XMLHelper.escape(license.getUrl()) + "\" ");
                 }
                 out.println("/>");
             }
             if (md.getHomePage() != null || md.getDescription() != null) {
                 out.print("\t\t<description");
                 if (md.getHomePage() != null) {
-                    out.print(" homepage=\"" + md.getHomePage() + "\"");
+                    out.print(" homepage=\"" + XMLHelper.escape(md.getHomePage()) + "\"");
                 }
                 if (md.getDescription() != null && md.getDescription().trim().length() > 0) {
                     out.println(">");
-                    out.println("\t\t" + md.getDescription());
+                    out.println("\t\t" + XMLHelper.escape(md.getDescription()));
                     out.println("\t\t</description>");
                 } else {
                     out.println(" />");
