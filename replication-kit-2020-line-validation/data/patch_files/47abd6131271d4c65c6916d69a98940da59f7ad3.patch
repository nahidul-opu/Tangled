From 47abd6131271d4c65c6916d69a98940da59f7ad3 Mon Sep 17 00:00:00 2001
From: Phil Steitz <psteitz@apache.org>
Date: Sat, 14 Feb 2015 00:04:17 +0000
Subject: [PATCH] Updated component versions; made PCF pool-setting consistent.
 JIRA: DBCP-412.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/dbcp/trunk@1659726 13f79535-47bb-0310-9956-ffa450edef68
---
 doc/BasicDataSourceExample.java   | 15 +++++++--------
 doc/PoolingDataSourceExample.java | 12 ++++++------
 doc/PoolingDriverExample.java     | 17 +++++++++--------
 3 files changed, 22 insertions(+), 22 deletions(-)

diff --git a/doc/BasicDataSourceExample.java b/doc/BasicDataSourceExample.java
index 7fe2f43f6a..cb700b7fec 100644
--- a/doc/BasicDataSourceExample.java
+++ b/doc/BasicDataSourceExample.java
@@ -39,18 +39,17 @@
 
 //
 // To compile this example, you'll want:
-//  * commons-pool-1.5.6.jar
-//  * commons-dbcp-1.3.jar (JDK 1.4-1.5) or commons-dbcp-1.4 (JDK 1.6+)
-//  * j2ee.jar (for the javax.sql classes)
+//  * commons-pool-2.3.jar
+//  * commons-dbcp-2.1.jar 
 // in your classpath.
 //
 // To run this example, you'll want:
-//  * commons-pool-1.5.6.jar
-//  * commons-dbcp-1.3.jar (JDK 1.4-1.5) or commons-dbcp-1.4 (JDK 1.6+)
-//  * j2ee.jar (for the javax.sql classes)
-//  * the classes for your (underlying) JDBC driver
+//  * commons-pool-2.3.jar
+//  * commons-dbcp-2.1.jar 
+//  * commons-logging-1.2.jar
 // in your classpath.
 //
+//
 // Invoke the class using two arguments:
 //  * the connect string for your underlying JDBC driver
 //  * the query you'd like to execute
@@ -60,7 +59,7 @@
 //
 // For example:
 //  java -Djdbc.drivers=oracle.jdbc.driver.OracleDriver \
-//       -classpath commons-pool-1.5.6.jar:commons-dbcp-1.4.jar:j2ee.jar:oracle-jdbc.jar:. \
+//       -classpath commons-pool-2.3.jar:commons-dbcp-2.1.jar:oracle-jdbc.jar:commons-logging-1.2.jar. \
 //       PoolingDataSourceExample
 //       "jdbc:oracle:thin:scott/tiger@myhost:1521:mysid"
 //       "SELECT * FROM DUAL"
diff --git a/doc/PoolingDataSourceExample.java b/doc/PoolingDataSourceExample.java
index 71a3807fca..2a12c74898 100644
--- a/doc/PoolingDataSourceExample.java
+++ b/doc/PoolingDataSourceExample.java
@@ -47,14 +47,14 @@
 
 //
 // To compile this example, you'll want:
-//  * commons-pool2-2.2.jar
-//  * commons-dbcp2-2.0.jar
+//  * commons-pool2-2.3.jar
+//  * commons-dbcp2-2.1.jar
 // in your classpath.
 //
 // To run this example, you'll want:
-//  * commons-pool2-2.2.jar
-//  * commons-dbcp2-2.0.jar
-//  * commons-logging-1.1.3.jar
+//  * commons-pool2-2.3.jar
+//  * commons-dbcp2-2.1.jar
+//  * commons-logging-1.2.jar
 //  * the classes for your (underlying) JDBC driver
 // in your classpath.
 //
@@ -67,7 +67,7 @@
 //
 // For example:
 //  java -Djdbc.drivers=org.h2.Driver \
-//       -classpath commons-pool2-2.2.jar:commons-dbcp2-2.0.jar:commons-logging-1.1.3.jar:h2-1.3.152.jar:. \
+//       -classpath commons-pool2-2.3.jar:commons-dbcp2-2.1.jar:commons-logging-1.2.jar:h2-1.3.152.jar:. \
 //       PoolingDataSourceExample \
 //       "jdbc:h2:~/test" \
 //       "SELECT 1"
diff --git a/doc/PoolingDriverExample.java b/doc/PoolingDriverExample.java
index 597e92ccbb..4d2dc0cdba 100644
--- a/doc/PoolingDriverExample.java
+++ b/doc/PoolingDriverExample.java
@@ -39,17 +39,15 @@
 // Here's a simple example of how to use the PoolingDriver.
 //
 
-//
 // To compile this example, you'll want:
-//  * commons-pool-1.5.6.jar
-//  * commons-dbcp-1.3.jar (JDK 1.4-1.5) or commons-dbcp-1.4 (JDK 1.6+)
+//  * commons-pool-2.3.jar
+//  * commons-dbcp-2.1.jar 
 // in your classpath.
 //
 // To run this example, you'll want:
-//  * commons-collections.jar
-//  * commons-pool-1.5.6.jar
-//  * commons-dbcp-1.3.jar (JDK 1.4-1.5) or commons-dbcp-1.4 (JDK 1.6+)
-//  * the classes for your (underlying) JDBC driver
+//  * commons-pool-2.3.jar
+//  * commons-dbcp-2.1.jar 
+//  * commons-logging-1.2.jar
 // in your classpath.
 //
 // Invoke the class using two arguments:
@@ -61,7 +59,7 @@
 //
 // For example:
 //  java -Djdbc.drivers=oracle.jdbc.driver.OracleDriver \
-//       -classpath commons-pool-1.5.6.jar:commons-dbcp-1.4.jar:oracle-jdbc.jar:. \
+//       -classpath commons-pool-2.3.jar:commons-dbcp-2.1.jar:oracle-jdbc.jar:commons-logging-1.2.jar. \
 //       PoolingDriverExample \
 //       "jdbc:oracle:thin:scott/tiger@myhost:1521:mysid" \
 //       "SELECT * FROM DUAL"
@@ -174,6 +172,9 @@ public static void setupDriver(String connectURI) throws Exception {
         //
         ObjectPool<PoolableConnection> connectionPool =
             new GenericObjectPool<>(poolableConnectionFactory);
+        
+        // Set the factory's pool property to the owning pool
+        poolableConnectionFactory.setPool(connectionPool);
 
         //
         // Finally, we create the PoolingDriver itself...
