From dce29e150679606d764c15200a5d1f6bccaeca95 Mon Sep 17 00:00:00 2001
From: Ralph Goers <rgoers@apache.org>
Date: Mon, 16 Nov 2009 06:45:51 +0000
Subject: [PATCH] Apply patch for VFS-227

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/vfs/branches/VFS281@880624 13f79535-47bb-0310-9956-ffa450edef68
---
 .../apache/commons/vfs/provider/FileContentThreadData.java   | 4 ++--
 xdocs/changes.xml                                            | 5 ++++-
 2 files changed, 6 insertions(+), 3 deletions(-)

diff --git a/core/src/main/java/org/apache/commons/vfs/provider/FileContentThreadData.java b/core/src/main/java/org/apache/commons/vfs/provider/FileContentThreadData.java
index aa5c758ddd..b02fa87d42 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/FileContentThreadData.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/FileContentThreadData.java
@@ -82,7 +82,7 @@ public Object removeInstr(int pos)
 
     public void removeInstr(InputStream instr)
     {
-        this.rastrs.remove(instr);
+        this.instrs.remove(instr);
     }
 
     public Object removeRastr(int pos)
@@ -92,7 +92,7 @@ public Object removeRastr(int pos)
 
     public void removeRastr(RandomAccessContent ras)
     {
-        this.instrs.remove(ras);
+        this.rastrs.remove(ras);
     }
 
     public boolean hasStreams()
diff --git a/xdocs/changes.xml b/xdocs/changes.xml
index 93376e9de6..123a72dde6 100644
--- a/xdocs/changes.xml
+++ b/xdocs/changes.xml
@@ -23,9 +23,12 @@
 
   <body>
     <release version="2.0" date="in SVN" description="">
+      <action dev="rgoers" type="fix" issue="VFS-227" due-to="Sergey Vladimirov">
+        InputStream and RandomAccessContent memory leak in FileContentThreadData
+      </action>
       <action dev="rgoers" type="update" issue="VFS-263" due-to="Ingo Maas">
         WebdavFileObject does not implement doSetAttribute()
-      </action>        
+      </action>
       <action dev="rgoers" type="fix" issue="VFS-259" due-to="Marek Zawirski">
         Http and Webdav FIleContentInfoFactory: undress to AbstractFileObject before casting
       </action>
