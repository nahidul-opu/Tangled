From b8de740e20a2dc24db4a9acf5b3ae5affd28d8e9 Mon Sep 17 00:00:00 2001
From: Maja Kabiljo <majakabiljo@fb.com>
Date: Tue, 5 Nov 2013 13:50:46 -0500
Subject: [PATCH] GIRAPH-791: HiveGiraphRunner picks -D options too late
 (majakabiljo)

---
 CHANGELOG                                                   | 2 ++
 .../main/java/org/apache/giraph/hive/HiveGiraphRunner.java  | 6 +++---
 2 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/CHANGELOG b/CHANGELOG
index 7df5b3e68..d970fa3df 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,8 @@
 Giraph Change Log
 
 Release 1.1.0 - unreleased
+  GIRAPH-791: HiveGiraphRunner picks -D options too late (majakabiljo)
+
   GIRAPH-790: Add a way to automatically retry a job (majakabiljo)
 
   GIRAPH-789: Upgrade hive-io to 0.20 - less metastore accesses (majakabiljo)
diff --git a/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java b/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java
index cbcd78808..723a48b11 100644
--- a/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java
+++ b/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java
@@ -444,6 +444,9 @@ private CommandLine handleCommandLine(String[] args) throws ParseException,
       throw new InterruptedException();
     }
 
+    // pick up -hiveconf arguments (put -D arguments from command line to conf)
+    HiveUtils.processHiveconfOptions(cmdln.getOptionValues("hiveconf"), conf);
+
     // Giraph classes
     String computationClassStr = cmdln.getOptionValue("computationClass");
     if (computationClassStr != null) {
@@ -544,9 +547,6 @@ parameters[1], elementOrNull(parameters, 2),
 
     isVerbose = cmdln.hasOption("verbose");
 
-    // pick up -hiveconf arguments
-    HiveUtils.processHiveconfOptions(cmdln.getOptionValues("hiveconf"), conf);
-
     processMoreArguments(cmdln);
 
     return cmdln;
