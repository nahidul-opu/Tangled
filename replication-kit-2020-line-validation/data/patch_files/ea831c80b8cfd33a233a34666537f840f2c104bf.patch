From ea831c80b8cfd33a233a34666537f840f2c104bf Mon Sep 17 00:00:00 2001
From: Maja Kabiljo <majakabiljo@maja-mbp.thefacebook.com>
Date: Mon, 11 Mar 2013 21:21:58 -0700
Subject: [PATCH] GIRAPH-554: Set PartitionContext in InternalVertexRunner
 (majakabiljo)

---
 CHANGELOG                                                      | 2 ++
 .../java/org/apache/giraph/utils/InternalVertexRunner.java     | 3 +++
 2 files changed, 5 insertions(+)

diff --git a/CHANGELOG b/CHANGELOG
index 90d626f05..9ca3b3bc9 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,8 @@
 Giraph Change Log
 
 Release 0.2.0 - unreleased
+  GIRAPH-554: Set PartitionContext in InternalVertexRunner (majakabiljo)
+
   GIRAPH-559: Giraph build breaks (nitay)
 
   GIRAPH-550: HiveVertexReader should call initialize, not users (nitay)
diff --git a/giraph-core/src/main/java/org/apache/giraph/utils/InternalVertexRunner.java b/giraph-core/src/main/java/org/apache/giraph/utils/InternalVertexRunner.java
index 7848d1c8f..798948306 100644
--- a/giraph-core/src/main/java/org/apache/giraph/utils/InternalVertexRunner.java
+++ b/giraph-core/src/main/java/org/apache/giraph/utils/InternalVertexRunner.java
@@ -138,6 +138,9 @@ public static Iterable<String> run(
       if (classes.hasWorkerContextClass()) {
         conf.setWorkerContextClass(classes.getWorkerContextClass());
       }
+      if (classes.hasPartitionContextClass()) {
+        conf.setMasterComputeClass(classes.getPartitionContextClass());
+      }
       if (classes.hasCombinerClass()) {
         conf.setVertexCombinerClass(classes.getCombinerClass());
       }
