From ffc6adf7d493def070e26592bf828accbeecef2d Mon Sep 17 00:00:00 2001
From: "Gary D. Gregory" <ggregory@apache.org>
Date: Wed, 16 May 2012 16:34:18 +0000
Subject: [PATCH] [VFS-408] CompressedFileFileObject Exception thrown when
 container file has no extension.

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/vfs/trunk@1339256 13f79535-47bb-0310-9956-ffa450edef68
---
 .../provider/compressed/CompressedFileFileObject.java    | 9 ++++-----
 src/changes/changes.xml                                  | 3 +++
 2 files changed, 7 insertions(+), 5 deletions(-)

diff --git a/core/src/main/java/org/apache/commons/vfs2/provider/compressed/CompressedFileFileObject.java b/core/src/main/java/org/apache/commons/vfs2/provider/compressed/CompressedFileFileObject.java
index fdd7eb4d0d..48e7b15b5a 100644
--- a/core/src/main/java/org/apache/commons/vfs2/provider/compressed/CompressedFileFileObject.java
+++ b/core/src/main/java/org/apache/commons/vfs2/provider/compressed/CompressedFileFileObject.java
@@ -40,12 +40,11 @@ protected CompressedFileFileObject(AbstractFileName name, FileObject container,
         // todo, add getBaseName(String) to FileName
         String basename = container.getName().getBaseName();
         int pos = basename.lastIndexOf('.');
-        basename = basename.substring(0, pos);
-
-        children = new String[]
+        if (pos > 0)
         {
-            basename
-        };
+            basename = basename.substring(0, pos);
+        }
+        children = new String[] { basename };
     }
 
     /**
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 5b6365430a..ac8d2dc797 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -23,6 +23,9 @@
 
   <body>
     <release version="2.1" date="TBD" description="">
+      <action issue="VFS-408" dev="ggregory" type="update" due-to="anilm2@yahoo.com">
+        CompressedFileFileObject Exception thrown when container file has no extension.
+      </action>
       <action issue="VFS-400" dev="ggregory" type="add">
         Add a FileSelector based on regular expressions.
       </action>
