From 0dc916659db0e3a764a0e614fc61012ce9eac4d2 Mon Sep 17 00:00:00 2001
From: Ferdy Galema <ferdy@apache.org>
Date: Sun, 8 Apr 2012 15:49:27 +0000
Subject: [PATCH] GORA-115 Flushing HBaseStore should flush all HTable
 instances.

git-svn-id: https://svn.apache.org/repos/asf/gora/trunk@1311031 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                                   | 1 +
 .../org/apache/gora/hbase/store/HBaseTableConnection.java     | 4 +++-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index a7e2def11..790d19e69 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -5,6 +5,7 @@
 Gora Change Log
 
 0.2 Release:
+* GORA-115 Flushing HBaseStore should flush all HTable instances. (ferdy)
 
 * Make hbase autoflush default to false and make autoflush configurable rather than hardcoded (stack via lewismc)
 
diff --git a/gora-hbase/src/main/java/org/apache/gora/hbase/store/HBaseTableConnection.java b/gora-hbase/src/main/java/org/apache/gora/hbase/store/HBaseTableConnection.java
index 28c948bc3..800dc69e2 100644
--- a/gora-hbase/src/main/java/org/apache/gora/hbase/store/HBaseTableConnection.java
+++ b/gora-hbase/src/main/java/org/apache/gora/hbase/store/HBaseTableConnection.java
@@ -235,7 +235,9 @@ public long incrementColumnValue(byte[] row, byte[] family, byte[] qualifier,
 
   @Override
   public void flushCommits() throws IOException {
-    getTable().flushCommits();
+    for (HTable table : pool) {
+      table.flushCommits();
+    }
   }
 
   @Override
