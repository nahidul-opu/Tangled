From d31db960ee61e50c8ea5067a6cf876b426f0e313 Mon Sep 17 00:00:00 2001
From: Scokart Gilles <gscokart@apache.org>
Date: Wed, 6 Aug 2008 09:39:32 +0000
Subject: [PATCH] fix unit test on IBM JVM (probably broken by IVY-868)

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@683200 13f79535-47bb-0310-9956-ffa450edef68
---
 test/java/org/apache/ivy/ant/IvyAntSettingsTest.java        | 2 +-
 test/java/org/apache/ivy/ant/IvyConfigureTest.java          | 2 +-
 .../org/apache/ivy/core/NormalRelativeUrlResolverTest.java  | 6 +++---
 3 files changed, 5 insertions(+), 5 deletions(-)

diff --git a/test/java/org/apache/ivy/ant/IvyAntSettingsTest.java b/test/java/org/apache/ivy/ant/IvyAntSettingsTest.java
index 168f55102..fe920ce71 100644
--- a/test/java/org/apache/ivy/ant/IvyAntSettingsTest.java
+++ b/test/java/org/apache/ivy/ant/IvyAntSettingsTest.java
@@ -100,7 +100,7 @@ public void testFile() throws Exception {
         assertEquals(new File("build/cache"), settings.getDefaultCache());
         assertEquals(new File("test/repositories/ivysettings.xml").getAbsolutePath(), settings
                 .getVariables().getVariable("ivy.settings.file"));
-        assertEquals(new File("test/repositories/ivysettings.xml").toURL().toExternalForm(),
+        assertEquals(new File("test/repositories/ivysettings.xml").toURI().toURL().toExternalForm(),
             settings.getVariables().getVariable("ivy.settings.url"));
         assertEquals(new File("test/repositories").getAbsolutePath(), settings.getVariables().getVariable(
             "ivy.settings.dir"));
diff --git a/test/java/org/apache/ivy/ant/IvyConfigureTest.java b/test/java/org/apache/ivy/ant/IvyConfigureTest.java
index 169343f6a..955a08be5 100644
--- a/test/java/org/apache/ivy/ant/IvyConfigureTest.java
+++ b/test/java/org/apache/ivy/ant/IvyConfigureTest.java
@@ -103,7 +103,7 @@ public void testFile() throws Exception {
         assertEquals(new File("build/cache"), settings.getDefaultCache());
         assertEquals(new File("test/repositories/ivysettings.xml").getAbsolutePath(), settings
                 .getVariables().getVariable("ivy.settings.file"));
-        assertEquals(new File("test/repositories/ivysettings.xml").toURL().toExternalForm(),
+        assertEquals(new File("test/repositories/ivysettings.xml").toURI().toURL().toExternalForm(),
             settings.getVariables().getVariable("ivy.settings.url"));
         assertEquals(new File("test/repositories").getAbsolutePath(), settings.getVariables().getVariable(
             "ivy.settings.dir"));
diff --git a/test/java/org/apache/ivy/core/NormalRelativeUrlResolverTest.java b/test/java/org/apache/ivy/core/NormalRelativeUrlResolverTest.java
index 639123eeb..861a5ea55 100644
--- a/test/java/org/apache/ivy/core/NormalRelativeUrlResolverTest.java
+++ b/test/java/org/apache/ivy/core/NormalRelativeUrlResolverTest.java
@@ -45,9 +45,9 @@ public void testRelativeMixedURL() throws MalformedURLException {
     public void testFileAndUrlWithAbsoluteFile() throws MalformedURLException {
         URL base = new URL("file://xxx/file.txt");
         File absFile = new File(".").getAbsoluteFile();
-        assertEquals(absFile.toURL(), t.getURL(base , absFile.toString() , null));
-        assertEquals(absFile.toURL(), t.getURL(base , absFile.toString() , ""));
-        assertEquals(absFile.toURL(), t.getURL(base , absFile.toString() , "somthing.txt"));
+        assertEquals(absFile.toURI().toURL(), t.getURL(base , absFile.toString() , null));
+        assertEquals(absFile.toURI().toURL(), t.getURL(base , absFile.toString() , ""));
+        assertEquals(absFile.toURI().toURL(), t.getURL(base , absFile.toString() , "somthing.txt"));
     }
 
     public void testFileAndUrlWithRelativeFile() throws MalformedURLException {
