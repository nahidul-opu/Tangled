From 4708138cb7de377a96fe17288a1daba43d7c8357 Mon Sep 17 00:00:00 2001
From: Maarten Coene <maartenc@apache.org>
Date: Mon, 6 Oct 2008 21:02:33 +0000
Subject: [PATCH] FIX: Can't use latest.release for pom dependencies (IVY-936)

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@702262 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                                 | 1 +
 .../ivy/plugins/parser/m2/PomModuleDescriptorBuilder.java   | 6 ++++++
 2 files changed, 7 insertions(+)

diff --git a/CHANGES.txt b/CHANGES.txt
index 0da1eee63..84af90104 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -101,6 +101,7 @@ for detailed view of each issue, please consult http://issues.apache.org/jira/br
 - FIX: Can't download files containing space or + in their names by HTTP (IVY-923)
 - FIX: Maven2 parser doesn't support POMs with <model> as root (IVY-932)
 - FIX: Default retrieve, publish and deliver patterns doesn't include the [classifier] token (IVY-935)
+- FIX: Can't use latest.release for pom dependencies (IVY-936)
 
    2.0.0-rc1
 =====================================
diff --git a/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorBuilder.java b/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorBuilder.java
index a8df2721b..c3f276e00 100644
--- a/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorBuilder.java
+++ b/src/java/org/apache/ivy/plugins/parser/m2/PomModuleDescriptorBuilder.java
@@ -215,6 +215,12 @@ public ModuleDescriptor getModuleDescriptor() {
     public void setModuleRevId(String groupId, String artifactId, String version) {
         mrid = ModuleRevisionId.newInstance(groupId, artifactId, version);
         ivyModuleDescriptor.setModuleRevisionId(mrid);
+        
+        if ((version == null) || version.endsWith("SNAPSHOT")) {
+            ivyModuleDescriptor.setStatus("integration");
+        } else {
+            ivyModuleDescriptor.setStatus("release");
+        }
      }
     
     public void setHomePage(String homePage) {
