From d6ae360653de7813c0d15e315d733aaee372df3d Mon Sep 17 00:00:00 2001
From: Thomas Vandahl <tv@apache.org>
Date: Mon, 9 Jan 2017 19:36:17 +0000
Subject: [PATCH] JCS-171: Multiple CacheEventQueue.QProcessor spawned for the
 same cache region

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/jcs/trunk@1778038 13f79535-47bb-0310-9956-ffa450edef68
---
 .../java/org/apache/commons/jcs/engine/CacheEventQueue.java   | 4 ++--
 src/changes/changes.xml                                       | 3 +++
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/commons-jcs-core/src/main/java/org/apache/commons/jcs/engine/CacheEventQueue.java b/commons-jcs-core/src/main/java/org/apache/commons/jcs/engine/CacheEventQueue.java
index f4904dfdd..58fc27b3b 100644
--- a/commons-jcs-core/src/main/java/org/apache/commons/jcs/engine/CacheEventQueue.java
+++ b/commons-jcs-core/src/main/java/org/apache/commons/jcs/engine/CacheEventQueue.java
@@ -200,7 +200,7 @@ protected class QProcessor
         public void run()
         {
 
-            while ( isAlive() )
+            while ( CacheEventQueue.this.isAlive() )
             {
                 AbstractCacheEvent event = null;
 
@@ -223,7 +223,7 @@ public void run()
                     stopProcessing();
                 }
 
-                if ( event != null && isWorking() && isAlive() )
+                if ( event != null && isWorking() && CacheEventQueue.this.isAlive() )
                 {
                     event.run();
                 }
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 3f3d29f9c..98fb7b61a 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -20,6 +20,9 @@
 	</properties>
 	<body>
         <release version="2.1" date="unreleased">
+            <action issue="JCS-171" dev="tv" type="fix" due-to="Wiktor Niesiobedzki">
+                Multiple CacheEventQueue.QProcessor spawned for the same cache region 
+            </action>
         </release>
         <release version="2.0" date="2016-12-25" description="JDK 1.6 based major release">
             <action issue="JCS-119" dev="tv" type="update">
