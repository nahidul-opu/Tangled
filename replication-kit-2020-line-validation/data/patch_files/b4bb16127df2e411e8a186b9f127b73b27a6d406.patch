From b4bb16127df2e411e8a186b9f127b73b27a6d406 Mon Sep 17 00:00:00 2001
From: Xavier Hanin <xavier@apache.org>
Date: Thu, 7 Feb 2008 17:22:12 +0000
Subject: [PATCH] FIX: Branch attribute considered as both a standard and extra
 attribute on module info (IVY-726)

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@619514 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                                | 1 +
 .../ivy/plugins/parser/xml/XmlModuleDescriptorParser.java  | 2 +-
 test/java/org/apache/ivy/ant/IvyInfoTest.java              | 7 +++++++
 3 files changed, 9 insertions(+), 1 deletion(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index e51fd2461..b363fd79f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -78,6 +78,7 @@ for detailed view of each issue, please consult http://issues.apache.org/jira/br
 - IMPROVEMENT: Downgrade Ant version requirement to 1.6 to build Ivy (IVY-687)
 - IMPROVEMENT: In the ResolveReport class, add the possibility to filter the evicted module while getting the list of DownloadArtifact (IVY-704) (thanks to Nicolas Lalevée)
 
+- FIX: Branch attribute considered as both a standard and extra attribute on module info (IVY-726)
 - FIX: Branch attribute not set on deliver when using a non default branch (IVY-724)
 - FIX: NullPointerException reported instead of error in ivy:cachepath (IVY-690)
 - FIX: NPE when calling retrieve if some artifacts are not available locally (IVY-712)
diff --git a/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorParser.java b/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorParser.java
index 5de1e6dbb..01625b3ad 100644
--- a/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorParser.java
+++ b/src/java/org/apache/ivy/plugins/parser/xml/XmlModuleDescriptorParser.java
@@ -533,7 +533,7 @@ private void infoStarted(Attributes attributes) {
             md.setModuleRevisionId(ModuleRevisionId.newInstance(org, module, branch,
                 revision, ExtendableItemHelper.getExtraAttributes(attributes, new String[] {
                         "organisation", "module", "revision", "status", "publication",
-                        "namespace", "default", "resolver"})));
+                        "branch", "namespace", "default", "resolver"})));
 
             String namespace = ivy.substitute(attributes.getValue("namespace"));
             if (namespace != null) {
diff --git a/test/java/org/apache/ivy/ant/IvyInfoTest.java b/test/java/org/apache/ivy/ant/IvyInfoTest.java
index 8fca1b8fe..6c5816911 100644
--- a/test/java/org/apache/ivy/ant/IvyInfoTest.java
+++ b/test/java/org/apache/ivy/ant/IvyInfoTest.java
@@ -58,4 +58,11 @@ public void testAll() throws Exception {
         assertEquals("myvalue", info.getProject().getProperty("ivy.extra.myextraatt"));
     }
 
+    public void testIVY726() throws Exception {
+        info.setFile(new File("test/java/org/apache/ivy/ant/ivy-info-all.xml"));
+        info.execute();
+        
+        assertTrue(info.getProject().getProperty("ivy.extra.branch") == null);
+    }
+
 }
\ No newline at end of file
