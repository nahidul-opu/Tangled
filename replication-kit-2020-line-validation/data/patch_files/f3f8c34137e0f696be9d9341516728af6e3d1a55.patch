From f3f8c34137e0f696be9d9341516728af6e3d1a55 Mon Sep 17 00:00:00 2001
From: Xavier Hanin <xavier@apache.org>
Date: Thu, 27 Apr 2006 15:18:11 +0000
Subject: [PATCH] FIX: NullPointerException when the creation of Ivy file in
 cache fails (IVY-234) (thanks to Maarten Coene)

git-svn-id: https://svn.apache.org/repos/asf/incubator/ivy/trunk@484313 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                          | 1 +
 src/java/fr/jayasoft/ivy/resolver/BasicResolver.java | 6 +++++-
 2 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index d32937942..acb57b040 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -36,6 +36,7 @@ for detailed view of each issue, please consult http://jira.jayasoft.org/
   - IMPROVE: comments now aren't lost when delivering ivy files (IVY-226)
   - IMPROVE: add sort of 'fallback'-mapping to the defaultconfmapping attribute (IVY-215)
 
+  - FIX: NullPointerException when the creation of Ivy file in cache fails (IVY-234)
   - FIX: Ivy file containing 2 different versions of the same module is not deliverd correctly (IVY-229)
   - FIX: ModuleRevisionId encode/decode doesn't work if revision is empty (IVY-233)
   - FIX: cachepath task should preserve the order of the dependencies (IVY-225)
diff --git a/src/java/fr/jayasoft/ivy/resolver/BasicResolver.java b/src/java/fr/jayasoft/ivy/resolver/BasicResolver.java
index 3ffca542d..becf8eb0f 100644
--- a/src/java/fr/jayasoft/ivy/resolver/BasicResolver.java
+++ b/src/java/fr/jayasoft/ivy/resolver/BasicResolver.java
@@ -384,7 +384,11 @@ public ResolvedModuleRevision getDependency(DependencyDescriptor dd, ResolveData
                 }
 	        }
         } catch (Exception e) {
-            Message.warn("impossible to copy ivy file to cache : "+ivyRef.getResource());
+            if (ivyRef == null) {
+                Message.warn("impossible to create ivy file in cache for module : " + resolvedMrid);
+            } else {
+                Message.warn("impossible to copy ivy file to cache : "+ivyRef.getResource());
+            }
         }
         
         data.getIvy().saveResolver(data.getCache(), systemMd, getName());
