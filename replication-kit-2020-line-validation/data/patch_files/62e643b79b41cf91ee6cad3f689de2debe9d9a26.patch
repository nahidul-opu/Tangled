From 62e643b79b41cf91ee6cad3f689de2debe9d9a26 Mon Sep 17 00:00:00 2001
From: Niall Pemberton <niallp@apache.org>
Date: Sat, 7 Oct 2006 01:20:14 +0000
Subject: [PATCH] Fix for BEANUTILS-250 - LazyDynaClass can create a
 DynaProperty with a "null" type

git-svn-id: https://svn.apache.org/repos/asf/jakarta/commons/proper/beanutils/trunk@453827 13f79535-47bb-0310-9956-ffa450edef68
---
 src/java/org/apache/commons/beanutils/LazyDynaClass.java | 6 +++++-
 xdocs/changes.xml                                        | 3 +++
 2 files changed, 8 insertions(+), 1 deletion(-)

diff --git a/src/java/org/apache/commons/beanutils/LazyDynaClass.java b/src/java/org/apache/commons/beanutils/LazyDynaClass.java
index 285caea3c..dc766c69c 100644
--- a/src/java/org/apache/commons/beanutils/LazyDynaClass.java
+++ b/src/java/org/apache/commons/beanutils/LazyDynaClass.java
@@ -167,7 +167,11 @@ public void add(String name) {
      *  restricted, so no new properties can be added
      */
     public void add(String name, Class type) {
-        add(new DynaProperty(name, type));
+        if (type == null) {
+            add(name);
+        } else {
+            add(new DynaProperty(name, type));
+        }
     }
 
     /**
diff --git a/xdocs/changes.xml b/xdocs/changes.xml
index df9654074..6b3d2a216 100644
--- a/xdocs/changes.xml
+++ b/xdocs/changes.xml
@@ -40,6 +40,9 @@ The <action> type attribute can be add,update,fix,remove.
   <body>
 
     <release version="1.7.1" date="in SVN">
+      <action dev="niallp" type="fix" issue="BEANUTILS-250">
+         LazyDynaClass can create a DynaProperty with a "null" type.
+      </action>
       <action dev="niallp" type="fix" issue="BEANUTILS-54" due-to="Pascal Grange">
          Add Implementation-Vendor-Id entry to jar's manifest.
       </action>
