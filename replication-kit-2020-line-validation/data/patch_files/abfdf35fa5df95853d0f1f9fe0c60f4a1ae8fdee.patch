From abfdf35fa5df95853d0f1f9fe0c60f4a1ae8fdee Mon Sep 17 00:00:00 2001
From: Stefan Bodewig <bodewig@apache.org>
Date: Sun, 7 May 2017 17:10:18 +0200
Subject: [PATCH] COMPRESS-393 don't try to invoke LZMAOutputStream#flush

---
 src/changes/changes.xml                                       | 4 ++++
 .../compress/compressors/lzma/LZMACompressorOutputStream.java | 1 -
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index a0e9b1546a9..a274ee7c4f6 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -110,6 +110,10 @@ The <action> type attribute can be add,update,fix,remove.
               due-to="Zbynek Vyskovsky">
         ZipEntry now exposes its data offset.
       </action>
+      <action issue="COMPRESS-393" type="fix" date="2017-05-07">
+        LZMACompressorOutputStream#flush would throw an exception
+        rather than be the NOP it promised to be.
+      </action>
     </release>
     <release version="1.13" date="2016-12-29"
              description="Release 1.13 - API compatible to 1.12 but requires Java 7 at runtime.">
diff --git a/src/main/java/org/apache/commons/compress/compressors/lzma/LZMACompressorOutputStream.java b/src/main/java/org/apache/commons/compress/compressors/lzma/LZMACompressorOutputStream.java
index 666926226c0..e6bdfa4557a 100644
--- a/src/main/java/org/apache/commons/compress/compressors/lzma/LZMACompressorOutputStream.java
+++ b/src/main/java/org/apache/commons/compress/compressors/lzma/LZMACompressorOutputStream.java
@@ -60,7 +60,6 @@ public void write(final byte[] buf, final int off, final int len) throws IOExcep
      */
     @Override
     public void flush() throws IOException {
-        out.flush();
     }
 
     /**
