From 038ee4d10d4bb8508db6cc905b851b68f08644b0 Mon Sep 17 00:00:00 2001
From: Sebastian Bazley <sebb@apache.org>
Date: Tue, 2 Nov 2010 19:03:32 +0000
Subject: [PATCH] VFS-326 Multi-threading issues - make private fields final
 where possible

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/vfs/trunk@1030179 13f79535-47bb-0310-9956-ffa450edef68
---
 .../org/apache/commons/vfs/FileFilterSelector.java |  6 +++---
 .../apache/commons/vfs/UserAuthenticationData.java |  2 +-
 .../vfs/operations/AbstractFileOperation.java      |  2 +-
 .../operations/AbstractFileOperationProvider.java  |  2 +-
 .../vfs/operations/DefaultFileOperations.java      |  4 ++--
 .../commons/vfs/operations/vcs/VcsLogEntry.java    | 10 +++++-----
 .../compressed/CompressedFileFileObject.java       |  2 +-
 .../commons/vfs/provider/ftp/FtpFileObject.java    |  2 +-
 .../vfs/provider/jar/JarURLConnectionImpl.java     |  8 ++++----
 .../commons/vfs/provider/ram/RamFileObject.java    |  2 +-
 .../provider/ram/RamFileRandomAccessContent.java   | 14 +++++++-------
 .../provider/ram/RamFileSystemConfigBuilder.java   |  2 +-
 .../vfs/provider/sftp/TrustEveryoneUserInfo.java   |  2 +-
 .../vfs/provider/url/UrlFileNameParser.java        |  4 ++--
 .../util/DelegatingFileSystemOptionsBuilder.java   |  2 +-
 15 files changed, 32 insertions(+), 32 deletions(-)

diff --git a/core/src/main/java/org/apache/commons/vfs/FileFilterSelector.java b/core/src/main/java/org/apache/commons/vfs/FileFilterSelector.java
index c3fbe2789b..a44cd2c62d 100644
--- a/core/src/main/java/org/apache/commons/vfs/FileFilterSelector.java
+++ b/core/src/main/java/org/apache/commons/vfs/FileFilterSelector.java
@@ -29,16 +29,16 @@ public class FileFilterSelector extends FileDepthSelector
     /**
      * The FileFilter.
      */
-    private FileFilter fileFilter;
+    private final FileFilter fileFilter;
 
     public FileFilterSelector()
     {
-        super(1, 1);
+        this(null);
     }
 
     public FileFilterSelector(FileFilter fileFilter)
     {
-        this();
+        super(1, 1);
         this.fileFilter = fileFilter;
     }
 
diff --git a/core/src/main/java/org/apache/commons/vfs/UserAuthenticationData.java b/core/src/main/java/org/apache/commons/vfs/UserAuthenticationData.java
index 8a620375cc..b3ec51d785 100644
--- a/core/src/main/java/org/apache/commons/vfs/UserAuthenticationData.java
+++ b/core/src/main/java/org/apache/commons/vfs/UserAuthenticationData.java
@@ -88,7 +88,7 @@ public String toString()
     public static final Type DOMAIN = new Type("domain");
 
     /** The authentication data. */
-    private Map authenticationData = new TreeMap();
+    private final Map authenticationData = new TreeMap();
 
     public UserAuthenticationData()
     {
diff --git a/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperation.java b/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperation.java
index 88ea3114ca..e22037e6f6 100644
--- a/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperation.java
+++ b/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperation.java
@@ -28,7 +28,7 @@ public abstract class AbstractFileOperation implements FileOperation
     /**
      * FileObject which the FileOperation is operate on.
      */
-    private FileObject fileObject;
+    private final FileObject fileObject;
 
     /**
      * @param file The FileObject.
diff --git a/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperationProvider.java b/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperationProvider.java
index 53d95269db..ec5850c46b 100644
--- a/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperationProvider.java
+++ b/core/src/main/java/org/apache/commons/vfs/operations/AbstractFileOperationProvider.java
@@ -39,7 +39,7 @@ public abstract class AbstractFileOperationProvider implements
      * "svn", "svnssh", but not for "file", etc. The Map has scheme as a key and
      * Colleaction of operations that are available for that scheme.
      */
-    private Collection operations = new ArrayList();
+    private final Collection operations = new ArrayList();
 
     /**
      * Gather available operations for the specified FileObject and put them into
diff --git a/core/src/main/java/org/apache/commons/vfs/operations/DefaultFileOperations.java b/core/src/main/java/org/apache/commons/vfs/operations/DefaultFileOperations.java
index ce7e4f01e5..a3d17172af 100644
--- a/core/src/main/java/org/apache/commons/vfs/operations/DefaultFileOperations.java
+++ b/core/src/main/java/org/apache/commons/vfs/operations/DefaultFileOperations.java
@@ -33,12 +33,12 @@ public class DefaultFileOperations implements FileOperations
     /**
      *
      */
-    private FileSystemManager fsmanager;
+    private final FileSystemManager fsmanager;
 
     /**
      *
      */
-    private FileObject fileObject;
+    private final FileObject fileObject;
 
     /**
      *
diff --git a/core/src/main/java/org/apache/commons/vfs/operations/vcs/VcsLogEntry.java b/core/src/main/java/org/apache/commons/vfs/operations/vcs/VcsLogEntry.java
index 0883765155..fe7677ebd1 100644
--- a/core/src/main/java/org/apache/commons/vfs/operations/vcs/VcsLogEntry.java
+++ b/core/src/main/java/org/apache/commons/vfs/operations/vcs/VcsLogEntry.java
@@ -28,27 +28,27 @@ public class VcsLogEntry
     /**
      *
      */
-    private String author;
+    private final String author;
 
     /**
      * Revision.
      */
-    private long revision;
+    private final long revision;
 
     /**
      * Message.
      */
-    private String message;
+    private final String message;
 
     /**
      * Date.
      */
-    private Calendar date;
+    private final Calendar date;
 
     /**
      * Path.
      */
-    private String path;
+    private final String path;
 
     /**
      *
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/compressed/CompressedFileFileObject.java b/core/src/main/java/org/apache/commons/vfs/provider/compressed/CompressedFileFileObject.java
index 658c6705cc..4b5991f6dd 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/compressed/CompressedFileFileObject.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/compressed/CompressedFileFileObject.java
@@ -35,7 +35,7 @@ public abstract class CompressedFileFileObject
     implements FileObject
 {
     private final FileObject container;
-    private String[] children;
+    private final String[] children;
 
     protected CompressedFileFileObject(FileName name, FileObject container, CompressedFileFileSystem fs)
     {
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/ftp/FtpFileObject.java b/core/src/main/java/org/apache/commons/vfs/provider/ftp/FtpFileObject.java
index fcc60a6c2f..7aa08ed39f 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/ftp/FtpFileObject.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/ftp/FtpFileObject.java
@@ -55,7 +55,7 @@ public class FtpFileObject
     private static final Map EMPTY_FTP_FILE_MAP = Collections.unmodifiableMap(new TreeMap());
     private static final FTPFile UNKNOWN = new FTPFile();
 
-    private Log log = LogFactory.getLog(FtpFileObject.class);
+    private final Log log = LogFactory.getLog(FtpFileObject.class);
     private final FtpFileSystem ftpFs;
     private final String relPath;
 
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/jar/JarURLConnectionImpl.java b/core/src/main/java/org/apache/commons/vfs/provider/jar/JarURLConnectionImpl.java
index 0d130bb2e2..36d169c5d2 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/jar/JarURLConnectionImpl.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/jar/JarURLConnectionImpl.java
@@ -43,10 +43,10 @@ public class JarURLConnectionImpl
     // This is because JarURLConnection SUCKS
     private static final String HACK_URL = "jar:http://somehost/somejar.jar!/";
 
-    private FileContent content;
-    private URL parentURL;
-    private JarFileObject file;
-    private String entryName;
+    private final FileContent content;
+    private final URL parentURL;
+    private final JarFileObject file;
+    private final String entryName;
 
     public JarURLConnectionImpl(JarFileObject file, FileContent content)
         throws MalformedURLException, FileSystemException
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileObject.java b/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileObject.java
index 1a0a7b6269..b1d749a451 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileObject.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileObject.java
@@ -39,7 +39,7 @@ public class RamFileObject extends AbstractFileObject implements FileObject
     /**
      * File System.
      */
-    private RamFileSystem fs;
+    private final RamFileSystem fs;
 
     /**
      * RAM File Object Data.
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileRandomAccessContent.java b/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileRandomAccessContent.java
index a7e0d57b9c..254a6b2c84 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileRandomAccessContent.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileRandomAccessContent.java
@@ -45,34 +45,34 @@ public class RamFileRandomAccessContent implements RandomAccessContent
     /**
      * buffer
      */
-    private byte[] buffer8 = new byte[8];
+    private final byte[] buffer8 = new byte[8];
 
     /**
      * buffer
      */
-    private byte[] buffer4 = new byte[4];
+    private final byte[] buffer4 = new byte[4];
 
     /**
      * buffer
      */
-    private byte[] buffer2 = new byte[2];
+    private final byte[] buffer2 = new byte[2];
 
     /**
      * buffer
      */
-    private byte[] buffer1 = new byte[1];
+    private final byte[] buffer1 = new byte[1];
 
     /**
      * Mode
      */
-    private RandomAccessMode mode;
+    private final RandomAccessMode mode;
 
     /**
      * File
      */
-    private RamFileObject file;
+    private final RamFileObject file;
 
-    private InputStream rafis;
+    private final InputStream rafis;
 
     /**
      * @param file The file to access.
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileSystemConfigBuilder.java b/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileSystemConfigBuilder.java
index 082dbb6b2d..b1bb084a4a 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileSystemConfigBuilder.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/ram/RamFileSystemConfigBuilder.java
@@ -30,7 +30,7 @@ public final class RamFileSystemConfigBuilder extends FileSystemConfigBuilder
     private static final String MAX_SIZE_KEY = "maxsize";
 
     /** config builder singleton. */
-    private static RamFileSystemConfigBuilder singleton = new RamFileSystemConfigBuilder();
+    private static final RamFileSystemConfigBuilder singleton = new RamFileSystemConfigBuilder();
 
     /**
      * Constructor
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/sftp/TrustEveryoneUserInfo.java b/core/src/main/java/org/apache/commons/vfs/provider/sftp/TrustEveryoneUserInfo.java
index c9c225da4c..ba6d8a32da 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/sftp/TrustEveryoneUserInfo.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/sftp/TrustEveryoneUserInfo.java
@@ -26,7 +26,7 @@
  */
 public class TrustEveryoneUserInfo implements UserInfo
 {
-    private Log log = LogFactory.getLog(TrustEveryoneUserInfo.class);
+    private final Log log = LogFactory.getLog(TrustEveryoneUserInfo.class);
 
     public String getPassphrase()
     {
diff --git a/core/src/main/java/org/apache/commons/vfs/provider/url/UrlFileNameParser.java b/core/src/main/java/org/apache/commons/vfs/provider/url/UrlFileNameParser.java
index 63aae30550..eef25cd6f8 100644
--- a/core/src/main/java/org/apache/commons/vfs/provider/url/UrlFileNameParser.java
+++ b/core/src/main/java/org/apache/commons/vfs/provider/url/UrlFileNameParser.java
@@ -33,8 +33,8 @@
  */
 public class UrlFileNameParser extends AbstractFileNameParser
 {
-    private URLFileNameParser url = new URLFileNameParser(80);
-    private GenericFileNameParser generic = new GenericFileNameParser();
+    private final URLFileNameParser url = new URLFileNameParser(80);
+    private final GenericFileNameParser generic = new GenericFileNameParser();
 
     public UrlFileNameParser()
     {
diff --git a/core/src/main/java/org/apache/commons/vfs/util/DelegatingFileSystemOptionsBuilder.java b/core/src/main/java/org/apache/commons/vfs/util/DelegatingFileSystemOptionsBuilder.java
index eb995d50ae..efc64a8fb6 100644
--- a/core/src/main/java/org/apache/commons/vfs/util/DelegatingFileSystemOptionsBuilder.java
+++ b/core/src/main/java/org/apache/commons/vfs/util/DelegatingFileSystemOptionsBuilder.java
@@ -55,7 +55,7 @@ public class DelegatingFileSystemOptionsBuilder
 
     private static final Map PRIMATIVE_TO_OBJECT = new TreeMap();
 
-    private Log log = LogFactory.getLog(DelegatingFileSystemOptionsBuilder.class);
+    private final Log log = LogFactory.getLog(DelegatingFileSystemOptionsBuilder.class);
 
     private final FileSystemManager manager;
 
