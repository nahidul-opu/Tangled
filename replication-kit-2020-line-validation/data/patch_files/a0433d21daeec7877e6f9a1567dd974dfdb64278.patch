From a0433d21daeec7877e6f9a1567dd974dfdb64278 Mon Sep 17 00:00:00 2001
From: aching <aching@apache.org>
Date: Wed, 13 Mar 2013 15:27:00 -0700
Subject: [PATCH] GIRAPH-561: Only print vertex/edge input classes if not null
 (aching)

---
 CHANGELOG                                          |  2 ++
 .../apache/giraph/io/ReverseEdgeDuplicator.java    |  2 +-
 .../org/apache/giraph/hive/HiveGiraphRunner.java   | 14 +++++++++-----
 3 files changed, 12 insertions(+), 6 deletions(-)

diff --git a/CHANGELOG b/CHANGELOG
index 9ca3b3bc9..b4802d10e 100644
--- a/CHANGELOG
+++ b/CHANGELOG
@@ -1,6 +1,8 @@
 Giraph Change Log
 
 Release 0.2.0 - unreleased
+  GIRAPH-561: Only print vertex/edge input classes if not null (aching)
+
   GIRAPH-554: Set PartitionContext in InternalVertexRunner (majakabiljo)
 
   GIRAPH-559: Giraph build breaks (nitay)
diff --git a/giraph-core/src/main/java/org/apache/giraph/io/ReverseEdgeDuplicator.java b/giraph-core/src/main/java/org/apache/giraph/io/ReverseEdgeDuplicator.java
index e85931f46..d6cb88612 100644
--- a/giraph-core/src/main/java/org/apache/giraph/io/ReverseEdgeDuplicator.java
+++ b/giraph-core/src/main/java/org/apache/giraph/io/ReverseEdgeDuplicator.java
@@ -32,7 +32,7 @@
  * Used to create an undirected graph from a directed input.
  * This class is a decorator around any other EdgeReader.
  *
- * @param <I> Vertex ID
+ * @param <I> Vertex id
  * @param <E> Edge Value
  */
 public class ReverseEdgeDuplicator<I extends WritableComparable,
diff --git a/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java b/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java
index c40c48252..8788a9dc6 100644
--- a/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java
+++ b/giraph-hive/src/main/java/org/apache/giraph/hive/HiveGiraphRunner.java
@@ -658,17 +658,21 @@ private void logOptions(GiraphConfiguration giraphConf) {
       LOG.info(LOG_PREFIX + "-hiveToVertexEdgesClass=" +
           hiveToVertexEdgesClass.getCanonicalName());
     }
-    LOG.info(LOG_PREFIX + "-vertexInputFormatClass=" +
-        classes.getVertexInputFormatClass().getCanonicalName());
-    logInputDesc(hiveVertexInputDescription, "vertex");
+    if (classes.getVertexInputFormatClass() != null) {
+      LOG.info(LOG_PREFIX + "-vertexInputFormatClass=" +
+          classes.getVertexInputFormatClass().getCanonicalName());
+      logInputDesc(hiveVertexInputDescription, "vertex");
+    }
 
     if (hiveToEdgeClass != null) {
       LOG.info(LOG_PREFIX + "-hiveToEdgeClass=" +
           hiveToEdgeClass.getCanonicalName());
     }
-    LOG.info(LOG_PREFIX + "-edgeInputFormatClass=" +
+    if (classes.getEdgeInputFormatClass() != null) {
+      LOG.info(LOG_PREFIX + "-edgeInputFormatClass=" +
         classes.getEdgeInputFormatClass().getCanonicalName());
-    logInputDesc(hiveEdgeInputDescription, "edge");
+      logInputDesc(hiveEdgeInputDescription, "edge");
+    }
 
     LOG.info(LOG_PREFIX + "-outputTable=" +
         hiveOutputDescription.getTableName());
