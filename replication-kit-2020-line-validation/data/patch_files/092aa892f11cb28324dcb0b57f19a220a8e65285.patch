From 092aa892f11cb28324dcb0b57f19a220a8e65285 Mon Sep 17 00:00:00 2001
From: Rory Winston <rwinston@apache.org>
Date: Thu, 5 Feb 2009 01:11:02 +0000
Subject: [PATCH] NET-236 Catch lower address ranges in isInRange()

git-svn-id: https://svn.apache.org/repos/asf/commons/proper/net/branches/NET_2_0@740965 13f79535-47bb-0310-9956-ffa450edef68
---
 src/main/java/org/apache/commons/net/util/SubnetUtils.java | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/src/main/java/org/apache/commons/net/util/SubnetUtils.java b/src/main/java/org/apache/commons/net/util/SubnetUtils.java
index 1dc80be75..41e20c1de 100644
--- a/src/main/java/org/apache/commons/net/util/SubnetUtils.java
+++ b/src/main/java/org/apache/commons/net/util/SubnetUtils.java
@@ -70,7 +70,11 @@ private SubnetInfo() {}
         private int high()          { return broadcast() - 1; }
 
         public boolean isInRange(String address)    { return isInRange(toInteger(address)); }
-        private boolean isInRange(int address)      { return ((address-low()) <= (high()-low())); }
+        
+        private boolean isInRange(int address)      { 
+            int diff = address-low();
+            return (diff >= 0 && (diff <= (high()-low())));
+        }
 
         public String getBroadcastAddress()         { return format(toArray(broadcast())); }
         public String getNetworkAddress()           { return format(toArray(network())); }
