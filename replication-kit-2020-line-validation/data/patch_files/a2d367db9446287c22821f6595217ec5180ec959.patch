From a2d367db9446287c22821f6595217ec5180ec959 Mon Sep 17 00:00:00 2001
From: Maarten Coene <maartenc@apache.org>
Date: Sun, 19 Aug 2012 15:52:13 +0000
Subject: [PATCH] FIX: Memory leak and infinite loop in ModuleId.java
 (IVY-1362)

git-svn-id: https://svn.apache.org/repos/asf/ant/ivy/core/trunk@1374776 13f79535-47bb-0310-9956-ffa450edef68
---
 CHANGES.txt                                          | 1 +
 src/java/org/apache/ivy/core/module/id/ModuleId.java | 2 +-
 2 files changed, 2 insertions(+), 1 deletion(-)

diff --git a/CHANGES.txt b/CHANGES.txt
index fa9a51c2b..4d624941f 100644
--- a/CHANGES.txt
+++ b/CHANGES.txt
@@ -130,6 +130,7 @@ for detailed view of each issue, please consult http://issues.apache.org/jira/br
 	
    trunk
 =====================================
+- FIX: Memory leak and infinite loop in ModuleId.java (IVY-1362)
 - FIX: Unnecessary warning when parent ivy.xml is not found (IVY-1346)
 - FIX: StackOverflowError when using <extends> and ../ivy.xml is not the parent ivy.xml (IVY-1437)
 - FIX: NullPointerExeption in AbstractOSGiResolver (IVY-1343) (thanks to Thomas Kurpick)
diff --git a/src/java/org/apache/ivy/core/module/id/ModuleId.java b/src/java/org/apache/ivy/core/module/id/ModuleId.java
index b55af1fda..b0a54099a 100644
--- a/src/java/org/apache/ivy/core/module/id/ModuleId.java
+++ b/src/java/org/apache/ivy/core/module/id/ModuleId.java
@@ -59,7 +59,7 @@ public static ModuleId newInstance(String org, String name) {
      *            the module id to return
      * @return a unit instance of the given module id.
      */
-    public static ModuleId intern(ModuleId moduleId) {
+    public static synchronized ModuleId intern(ModuleId moduleId) {
         ModuleId r = (ModuleId) CACHE.get(moduleId);
         if (r == null) {
             r = moduleId;
